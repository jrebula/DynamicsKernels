(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     71246,       1606]
NotebookOptionsPosition[     69542,       1543]
NotebookOutlinePosition[     69985,       1560]
CellTagsIndexPosition[     69942,       1557]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Simple constraint test system", "Title",
 CellChangeTimes->{{3.446917747848176*^9, 3.446917769908661*^9}, {
  3.4821408156397667`*^9, 3.4821408172821283`*^9}, {3.5787504167873793`*^9, 
  3.5787504649171915`*^9}, {3.57911183530281*^9, 3.5791118736550035`*^9}, {
  3.585846116724345*^9, 3.585846124898813*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<DynamicsWorkbench`\>\"", "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "Get", "[", 
    "\"\<C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\\
Branches\\\\jrebula\\\\ThreeDWalker\\\\DynamicsWorkbenchModifiedFixUJoint.m\>\
\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "outputFile", " ", "=", " ", 
     "\"\<C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\\
Branches\\\\jrebula\\\\ThreeDWalker\\\\trajectoryOptimization\\\\\
directConstraintOptimization\\\\basicTest\\\\mathematicaOutput.m\>\""}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "outputFile", " ", "=", " ", 
      "\"\<C:\\\\Users\\\\jrebula\\\\myProjectsSmaller\\\\dynamicWalking\\\\\
Branches\\\\jrebula\\\\ThreeDWalker\\\\mathematicaOutput.m\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Get", "[", 
      "\"\<C:\\\\Users\\\\jrebula\\\\myProjectsSmaller\\\\dynamicWalking\\\\\
Branches\\\\jrebula\\\\ThreeDWalker\\\\DynamicsWorkbenchModifiedFixUJoint.m\>\
\"", "]"}], ";"}], "\[IndentingNewLine]", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.446934412694668*^9, 3.4469344189176893`*^9}, {
  3.578516528511217*^9, 3.578516529344217*^9}, {3.5785166544342165`*^9, 
  3.578516694146217*^9}, {3.5792060817642174`*^9, 3.5792060831562176`*^9}, {
  3.5792061878082175`*^9, 3.5792061888462176`*^9}, {3.5792094935647335`*^9, 
  3.579209499756353*^9}, {3.579280721804109*^9, 3.5792807437184916`*^9}, {
  3.579280782524251*^9, 3.5792808152097864`*^9}, {3.579349741015477*^9, 
  3.579349757302409*^9}, {3.57962109159155*^9, 3.579621105682959*^9}, {
  3.583891099261829*^9, 3.583891103739829*^9}, {3.583891134494829*^9, 
  3.583891162118829*^9}}],

Cell[CellGroupData[{

Cell["Equations of motion", "Section",
 CellChangeTimes->{{3.44693654093233*^9, 3.446936542796586*^9}}],

Cell[CellGroupData[{

Cell["Two pendula", "Subsubsection",
 CellChangeTimes->{{3.4469363466535482`*^9, 3.446936373878829*^9}, {
  3.482141165062211*^9, 3.482141167065091*^9}, {3.578750332894991*^9, 
  3.578750374561157*^9}, {3.5787505538650856`*^9, 3.57875055490919*^9}, {
  3.579113333014105*^9, 3.5791133417771053`*^9}, {3.5791138535081053`*^9, 
  3.579113860292105*^9}, {3.579621146562046*^9, 3.579621146815072*^9}, {
  3.5797275177639565`*^9, 3.5797275705669565`*^9}, {3.5797338545449567`*^9, 
  3.5797338601569567`*^9}, {3.583891194053829*^9, 3.583891202370829*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NewModel", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pendulumOne", ",", "ground", ",", "Hinge", ",", 
    RowBox[{"Axis", "\[Rule]", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "M"}], ",", " ", 
    RowBox[{"Inertia", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "inertia", ",", " ", "0"}], "}"}]}], ",", " ", 
    RowBox[{"BodyToJnt", " ", "\[Rule]", " ", 
     RowBox[{
      RowBox[{"pendulumOne", "[", "3", "]"}], " ", "L"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddBody", "[", 
    RowBox[{"pendulumTwo", ",", "ground", ",", "Hinge", ",", 
     RowBox[{"Axis", "\[Rule]", 
      RowBox[{"ground", "[", "2", "]"}]}], ",", 
     RowBox[{"Mass", "\[Rule]", "M"}], ",", " ", 
     RowBox[{"Inertia", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "inertia", ",", " ", "0"}], "}"}]}], ",", " ", 
     RowBox[{"BodyToJnt", " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"pendulumTwo", "[", "3", "]"}], " ", "L"}]}], ",", " ", 
     RowBox[{"InbToJnt", " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"ground", "[", "3", "]"}], " ", "*", "1.5", " ", "*", " ", 
       "L"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{
   "pendulumOneContactPoint", ",", " ", "pendulumOne", ",", " ", "Fixed", ",",
     " ", 
    RowBox[{"InbToJnt", " ", "\[Rule]", " ", "0"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddBody", "[", 
    RowBox[{
    "pendulumTwoContactCircleCenter", ",", " ", "pendulumTwo", ",", " ", 
     "Fixed", ",", " ", 
     RowBox[{"InbToJnt", " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"pendulumTwo", "[", "3", "]"}], " ", "*", " ", 
       RowBox[{"(", 
        RowBox[{"L", " ", "-", " ", "Lc"}], ")"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circleCenterToContactPoint", " ", "=", 
   RowBox[{
    RowBox[{"PosCOM", "[", "pendulumOneContactPoint", "]"}], " ", "-", " ", 
    RowBox[{"PosCOM", "[", "pendulumTwoContactCircleCenter", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circleSurfaceToContactPointDirection", " ", "=", " ", 
   RowBox[{"circleCenterToContactPoint", " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
     "circleCenterToContactPoint", ".", "circleCenterToContactPoint"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"circleSurfaceTangent", "=", " ", 
    RowBox[{"Cross", "[", 
     RowBox[{"circleSurfaceToContactPointDirection", ",", " ", 
      RowBox[{"ground", "[", "2", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AddBody", "[", 
     RowBox[{
     "pendulumTwoContactPointOnCircle", ",", " ", 
      "pendulumTwoContactCircleCenter", ",", " ", "Fixed", ",", " ", 
      RowBox[{"Offset", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"circleSurfaceToContactPointDirection", ",", " ", 
         RowBox[{"ground", "[", "2", "]"}], ",", "circleSurfaceTangent"}], 
        "}"}]}], ",", 
      RowBox[{"InbToJnt", " ", "\[Rule]", " ", 
       RowBox[{
       "circleSurfaceToContactPointDirection", " ", "*", " ", 
        "contactCircleRadius"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddBody", "[", 
    RowBox[{
    "pendulumTwoContactPointOnCircle", ",", " ", 
     "pendulumTwoContactCircleCenter", ",", " ", "Fixed", ",", " ", 
     RowBox[{"InbToJnt", " ", "\[Rule]", " ", 
      RowBox[{
      "circleSurfaceToContactPointDirection", " ", "*", " ", 
       "contactCircleRadius"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grav", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", " ", "g"}], " ", "*", " ", 
    RowBox[{"ground", "[", "3", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"pendulumOne", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "pendulumOne", "]"}], " ", "*", " ", "grav"}], ",", 
    "0"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppFrc", "[", 
    RowBox[{"pendulumTwo", ",", 
     RowBox[{
      RowBox[{"Mass", "[", "pendulumTwo", "]"}], " ", "*", " ", "grav"}], ",",
      "0"}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AppFrc", "[", 
  RowBox[{"pendulumOne", ",", " ", 
   RowBox[{
   "contactForce", " ", "*", " ", "circleSurfaceToContactPointDirection"}], 
   ",", " ", 
   RowBox[{
    RowBox[{"PosCOM", "[", "pendulumTwoContactPointOnCircle", "]"}], " ", "-",
     " ", 
    RowBox[{"PosCOM", "[", "pendulumOne", "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"pendulumTwo", ",", " ", 
    RowBox[{
     RowBox[{"-", "contactForce"}], " ", "*", " ", 
     "circleSurfaceToContactPointDirection"}], ",", " ", 
    RowBox[{
     RowBox[{"PosCOM", "[", "pendulumTwoContactPointOnCircle", "]"}], " ", 
     "-", " ", 
     RowBox[{"PosCOM", "[", "pendulumTwo", "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"pendulumOne", ",", " ", 
    RowBox[{"inputTorque", " ", "*", " ", 
     RowBox[{"ground", "[", "2", "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446933798487845*^9, 3.4469338643521357`*^9}, {
   3.446933973115541*^9, 3.446933973964518*^9}, {3.446934165197138*^9, 
   3.446934196255003*^9}, {3.446934232495329*^9, 3.446934296806625*^9}, {
   3.4469343369097557`*^9, 3.446934396401021*^9}, {3.446934874977736*^9, 
   3.446934894293985*^9}, {3.44693499207298*^9, 3.446935146273335*^9}, {
   3.44693525471518*^9, 3.446935466215646*^9}, {3.446935962145954*^9, 
   3.446935976732356*^9}, {3.446936070668562*^9, 3.44693608258097*^9}, {
   3.4469363147903633`*^9, 3.446936338677568*^9}, 3.446936378812018*^9, {
   3.4471087351120424`*^9, 3.4471087378627677`*^9}, {3.4481026874620094`*^9, 
   3.448102702886552*^9}, {3.448102761625425*^9, 3.448102768122074*^9}, {
   3.448102820844346*^9, 3.4481028223004913`*^9}, {3.4821414061689053`*^9, 
   3.4821414214108224`*^9}, {3.4821414642524257`*^9, 3.482141476149533*^9}, {
   3.482141655136904*^9, 3.482141660013917*^9}, {3.482141725858597*^9, 
   3.4821417277513185`*^9}, {3.5787505024899487`*^9, 
   3.5787505075804577`*^9}, {3.578750795509248*^9, 3.578750833278024*^9}, {
   3.5787515081510377`*^9, 3.5787515744540377`*^9}, {3.5787516523330374`*^9, 
   3.5787516576120377`*^9}, 3.578751755209038*^9, {3.5787519016520376`*^9, 
   3.5787519046600375`*^9}, 3.578751984209038*^9, {3.5787520234300375`*^9, 
   3.5787520336910377`*^9}, {3.5787520869020376`*^9, 
   3.5787521186160374`*^9}, {3.5787521561120377`*^9, 
   3.5787521592220373`*^9}, {3.578752219320038*^9, 3.5787522391240377`*^9}, {
   3.578752342478038*^9, 3.5787523564200373`*^9}, {3.5787524939440374`*^9, 
   3.5787525420950375`*^9}, {3.5787526077960377`*^9, 
   3.5787526490530376`*^9}, {3.5787527942390375`*^9, 3.578752880006308*^9}, 
   3.578753553127974*^9, {3.578753590520713*^9, 3.578753590831744*^9}, {
   3.5787536331139717`*^9, 3.5787536912077804`*^9}, {3.578753746087268*^9, 
   3.5787537494146004`*^9}, {3.5787538261142697`*^9, 
   3.5787538356952276`*^9}, {3.5787539018298407`*^9, 
   3.5787539197406316`*^9}, {3.5787569081818776`*^9, 3.578756939778037*^9}, {
   3.5787569830193605`*^9, 3.5787570021842766`*^9}, {3.578757048379896*^9, 
   3.5787570921412716`*^9}, {3.5787571423192887`*^9, 
   3.5787572521772738`*^9}, {3.5787574736334233`*^9, 
   3.5787574787504234`*^9}, {3.5787595447984233`*^9, 
   3.5787596145914235`*^9}, {3.578761451693204*^9, 3.57876145545858*^9}, {
   3.578761545697603*^9, 3.578761547255759*^9}, {3.578761591118145*^9, 
   3.578761686961728*^9}, {3.578761830974128*^9, 3.5787618317922096`*^9}, {
   3.5787618807371035`*^9, 3.5787618823662663`*^9}, {3.5787619276167912`*^9, 
   3.5787619907801065`*^9}, {3.578762042038232*^9, 3.578762101291157*^9}, 
   3.5787624416331873`*^9, {3.578769908001306*^9, 3.5787699081383133`*^9}, {
   3.5788397042839365`*^9, 3.5788397058029366`*^9}, {3.5788397440249367`*^9, 
   3.578839746792937*^9}, 3.578850230916913*^9, 3.5788537759170055`*^9, {
   3.5788538806049933`*^9, 3.578853882016074*^9}, {3.578855936226568*^9, 
   3.578855937185623*^9}, 3.578856847970717*^9, {3.5791130524621053`*^9, 
   3.579113093611105*^9}, {3.5791131406851053`*^9, 3.579113157128105*^9}, {
   3.579113271606105*^9, 3.5791132719351053`*^9}, {3.579113753780105*^9, 
   3.5791137604351053`*^9}, {3.5791137947701054`*^9, 3.579113823346105*^9}, {
   3.5791139589021053`*^9, 3.579113992977105*^9}, {3.579114032934105*^9, 
   3.579114034339105*^9}, {3.5791993089470625`*^9, 3.57919933093032*^9}, {
   3.579199607483138*^9, 3.579199610697322*^9}, {3.5791997805290356`*^9, 
   3.5791997811030684`*^9}, {3.57919987326534*^9, 3.5791998752794547`*^9}, {
   3.5791999879849014`*^9, 3.579200031803337*^9}, {3.579200089401828*^9, 
   3.579200092030551*^9}, {3.579200124871559*^9, 3.579200127401104*^9}, {
   3.579200327077464*^9, 3.5792003596932793`*^9}, {3.5792004093750324`*^9, 
   3.579200449001752*^9}, {3.579200491232292*^9, 3.579200493857128*^9}, 
   3.5792009343529854`*^9, {3.5792009871542654`*^9, 3.579200991521702*^9}, {
   3.5792010681323624`*^9, 3.5792011505686054`*^9}, {3.5792012055811057`*^9, 
   3.579201206461194*^9}, {3.5792012926858153`*^9, 3.579201296718219*^9}, 
   3.5792013279053373`*^9, {3.5792014167872243`*^9, 3.5792014181483603`*^9}, {
   3.579201879400481*^9, 3.579201918732414*^9}, {3.579202076072216*^9, 
   3.5792020850502157`*^9}, {3.579202150902216*^9, 3.5792021567922163`*^9}, {
   3.579202686298216*^9, 3.579202761670216*^9}, 3.5792030344572163`*^9, {
   3.579203087813216*^9, 3.579203115587216*^9}, {3.579203165846216*^9, 
   3.579203167839216*^9}, {3.5792032164512157`*^9, 3.579203230118216*^9}, {
   3.579203302456216*^9, 3.579203335894216*^9}, {3.579203406129216*^9, 
   3.579203444544216*^9}, {3.579203477758216*^9, 3.579203524080216*^9}, {
   3.5792040793482175`*^9, 3.5792040822072177`*^9}, {3.5792053889792175`*^9, 
   3.5792054186752176`*^9}, {3.5792055940882177`*^9, 
   3.5792055946152177`*^9}, {3.579261865365672*^9, 3.579261871418672*^9}, {
   3.5792639068549676`*^9, 3.579264018773158*^9}, {3.5792640590131817`*^9, 
   3.579264136380063*^9}, {3.579264173390063*^9, 3.5792641763130627`*^9}, 
   3.579264253408063*^9, {3.5792642859850626`*^9, 3.579264288656063*^9}, {
   3.579265518001063*^9, 3.5792655464120626`*^9}, {3.579265578592063*^9, 
   3.579265610229063*^9}, {3.579265924505063*^9, 3.5792659274470625`*^9}, {
   3.5792659669660625`*^9, 3.579265978449063*^9}, {3.579266014224063*^9, 
   3.5792660494780626`*^9}, {3.5792661132200627`*^9, 3.579266139033063*^9}, {
   3.5792661969000626`*^9, 3.5792661996360626`*^9}, {3.579266286863063*^9, 
   3.579266326014063*^9}, {3.5792667038070617`*^9, 3.5792667062223034`*^9}, {
   3.5792669247001486`*^9, 3.579266956174296*^9}, {3.579266998879566*^9, 
   3.5792670286745453`*^9}, {3.579267104759153*^9, 3.5792671139850755`*^9}, {
   3.579267186170293*^9, 3.579267254478123*^9}, {3.579267424932167*^9, 
   3.5792674500366774`*^9}, {3.5792674928059535`*^9, 
   3.5792674946641397`*^9}, {3.5792696077410526`*^9, 
   3.5792697236490526`*^9}, {3.579280573583227*^9, 3.5792805737102904`*^9}, {
   3.579350619884746*^9, 3.5793506360616713`*^9}, {3.5793569531723795`*^9, 
   3.579356958803379*^9}, {3.579359544090401*^9, 3.579359550091201*^9}, {
   3.579359740344634*^9, 3.5793597446324916`*^9}, {3.579360060102974*^9, 
   3.57936006497046*^9}, {3.579360124796442*^9, 3.579360245450506*^9}, {
   3.5793621511330557`*^9, 3.5793621538363256`*^9}, {3.579620994989891*^9, 
   3.5796210809614873`*^9}, {3.579621125848975*^9, 3.5796211597323637`*^9}, {
   3.5796212086472545`*^9, 3.5796212135497446`*^9}, {3.5797289158629565`*^9, 
   3.5797290257509565`*^9}, {3.5797290748259563`*^9, 
   3.5797290795769567`*^9}, {3.5797291132749567`*^9, 
   3.5797291149259567`*^9}, {3.5797308265279565`*^9, 
   3.5797308288519564`*^9}, {3.579733865010957*^9, 3.579733912758957*^9}, 
   3.5797350239199567`*^9, {3.5797356218549566`*^9, 3.5797356231559563`*^9}, {
   3.5797366244279566`*^9, 3.5797366510839567`*^9}, 3.5797367007739563`*^9, {
   3.5797373913779564`*^9, 3.5797374199469566`*^9}, {3.583891221109829*^9, 
   3.5838912221978292`*^9}, {3.583891260458829*^9, 3.583891282438829*^9}, {
   3.583891342103829*^9, 3.583891417637829*^9}, {3.5838915012908287`*^9, 
   3.583891597845829*^9}, {3.583920369459629*^9, 3.5839203696246386`*^9}, {
   3.583920406040721*^9, 3.583920407977832*^9}, {3.5839205390363283`*^9, 
   3.5839205804736977`*^9}, {3.5839206183178625`*^9, 3.583920644745374*^9}, {
   3.583920685176687*^9, 3.58392070971809*^9}, 3.5839246016693716`*^9, {
   3.5839246358407364`*^9, 3.583924645443204*^9}, {3.583925024404046*^9, 
   3.5839250386281548`*^9}, {3.5839481494960995`*^9, 
   3.5839482047890997`*^9}, {3.5839483018260994`*^9, 
   3.5839483982250996`*^9}, {3.5839485431210995`*^9, 
   3.5839486435380993`*^9}, {3.5839487051190996`*^9, 3.5839487655041*^9}, 
   3.5839488548931*^9, {3.5839496158520994`*^9, 3.5839496160350995`*^9}, {
   3.5839500946720996`*^9, 3.5839501429620996`*^9}, {3.5839517500710993`*^9, 
   3.5839518224010997`*^9}, {3.5839518715060997`*^9, 
   3.5839519137970996`*^9}, {3.5839520006770997`*^9, 3.5839520264591*^9}, {
   3.5839520879880996`*^9, 3.5839521097871*^9}, {3.5839525287240996`*^9, 
   3.5839525306140995`*^9}, 3.5839526717281*^9, {3.5839528216291*^9, 
   3.5839528526140995`*^9}, {3.5839528883461*^9, 3.5839528909300995`*^9}, {
   3.5839529336621*^9, 3.5839529338750997`*^9}, {3.5839529798690996`*^9, 
   3.5839529945090995`*^9}, {3.5839530317871*^9, 3.5839531364430995`*^9}, {
   3.5839531798170996`*^9, 3.5839531834280996`*^9}, {3.5839532293480997`*^9, 
   3.5839532639950995`*^9}, {3.5839533053610992`*^9, 
   3.5839533199650993`*^9}, {3.5839552734540997`*^9, 
   3.5839553029400997`*^9}, {3.5839553700010996`*^9, 
   3.5839553760910997`*^9}, {3.5839555253950996`*^9, 
   3.5839556061840997`*^9}, {3.5839556383770995`*^9, 3.5839556596210995`*^9}, 
   3.5839556897541*^9, {3.5840224691297874`*^9, 3.5840224724667873`*^9}, {
   3.584022517215788*^9, 3.5840225189217873`*^9}, {3.585916990149495*^9, 
   3.585917006179307*^9}, {3.585917073522371*^9, 3.585917098255731*^9}, {
   3.585917238077607*^9, 3.585917288613863*^9}, {3.5859173691840773`*^9, 
   3.5859173977997994`*^9}, {3.585918059378735*^9, 3.5859180745612535`*^9}, {
   3.5859181340111976`*^9, 3.585918214712267*^9}, {3.5859186436541567`*^9, 
   3.585918652669058*^9}, {3.585918718936684*^9, 3.5859187311629066`*^9}, {
   3.5859188566854577`*^9, 3.58591886240903*^9}, {3.5859189041513667`*^9, 
   3.585918954735367*^9}, {3.5859189914063663`*^9, 3.5859190005663667`*^9}, {
   3.5859190336993666`*^9, 3.5859190400393667`*^9}, {3.5859191649353666`*^9, 
   3.5859192376023664`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5868853457148657`*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.5868853457188663`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate equations of motion, energies", "Subsubsection",
 CellChangeTimes->{{3.446936462821484*^9, 3.446936493067205*^9}, {
   3.4482332964944153`*^9, 3.448233342564022*^9}, {3.483287161868603*^9, 
   3.483287162519539*^9}, {3.5787553012144284`*^9, 3.5787553081574287`*^9}, 
   3.5787553808734283`*^9, {3.5787597465054235`*^9, 3.578759748089423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"totalMass", " ", "=", " ", 
    RowBox[{
     RowBox[{"Mass", "[", "pendulumOne", "]"}], " ", "+", " ", 
     RowBox[{"Mass", "[", "pendulumTwo", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalCOMPositionTimesMass", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Mass", "[", "pendulumOne", "]"}], 
      RowBox[{"PosCOM", "[", "pendulumOne", "]"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Mass", "[", "pendulumTwo", "]"}], 
      RowBox[{"PosCOM", "[", "pendulumTwo", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PEGravity", "=", 
    RowBox[{"-", 
     RowBox[{"totalCOMPositionTimesMass", ".", "grav"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PE", " ", "=", " ", "PEGravity"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"comVelocity", " ", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Mass", "[", "pendulumOne", "]"}], "*", 
        RowBox[{"VelCOM", "[", "pendulumOne", "]"}]}], " ", "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mass", "[", "pendulumTwo", "]"}], "*", 
        RowBox[{"VelCOM", "[", "pendulumTwo", "]"}]}]}], ")"}], " ", "/", " ",
      "totalMass"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KEPendulumOne", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Mass", "[", "pendulumOne", "]"}], "*", 
      RowBox[{
       RowBox[{"VelCOM", "[", "pendulumOne", "]"}], ".", 
       RowBox[{"VelCOM", "[", "pendulumOne", "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KEPendulumTwo", " ", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Mass", "[", "pendulumTwo", "]"}], "*", 
       RowBox[{
        RowBox[{"VelCOM", "[", "pendulumTwo", "]"}], ".", 
        RowBox[{"VelCOM", "[", "pendulumTwo", "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KELinear", " ", "=", " ", 
    RowBox[{"KEPendulumOne", " ", "+", "KEPendulumTwo"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KERotational", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Inertia", "[", "pendulumOne", "]"}], ".", 
        RowBox[{"AngVel", "[", "pendulumOne", "]"}], ".", 
        RowBox[{"AngVel", "[", "pendulumOne", "]"}]}], " ", "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Inertia", "[", "pendulumTwo", "]"}], ".", 
        RowBox[{"AngVel", "[", "pendulumTwo", "]"}], ".", 
        RowBox[{"AngVel", "[", "pendulumTwo", "]"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KE", " ", "=", " ", 
    RowBox[{"KELinear", " ", "+", " ", "KERotational"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eom", " ", "=", " ", 
   RowBox[{"EOM", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MM", ",", "rhs"}], "}"}], "=", 
    RowBox[{"MassMatrix", "[", "eom", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"FullSimplify", "[", "rhs", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446934958453143*^9, 3.4469349610737743`*^9}, {
   3.446935214939715*^9, 3.446935217192977*^9}, {3.4479841720295267`*^9, 
   3.447984174313526*^9}, {3.448097617390153*^9, 3.4480976660111527`*^9}, 
   3.4480990324075356`*^9, {3.4480990838986845`*^9, 3.4480990893202267`*^9}, 
   3.4821410703760595`*^9, {3.4902913471702175`*^9, 3.490291361226242*^9}, 
   3.490291394306774*^9, {3.4902916933210497`*^9, 3.490291716651715*^9}, {
   3.4902918000413895`*^9, 3.4902918026969204`*^9}, {3.4902956443947244`*^9, 
   3.490295651859471*^9}, {3.49029568645193*^9, 3.4902956952788124`*^9}, {
   3.490296043368618*^9, 3.4902960720574865`*^9}, {3.490296136357916*^9, 
   3.49029619200848*^9}, 3.490296227721051*^9, {3.4903044502652235`*^9, 
   3.490304457512948*^9}, {3.4912330241433697`*^9, 3.4912330244337873`*^9}, 
   3.4913154550057087`*^9, {3.5787553344854283`*^9, 3.5787553672654285`*^9}, {
   3.578759743247423*^9, 3.578759743728423*^9}, {3.578761398313866*^9, 
   3.578761403705405*^9}, {3.5787626893559575`*^9, 3.57876269818484*^9}, 
   3.5787628724162617`*^9, {3.57876304231625*^9, 3.578763076149633*^9}, 
   3.5787631622262397`*^9, 3.5787660950097313`*^9, 3.578768880586541*^9, 
   3.5787690062147264`*^9, 3.5787690575076604`*^9, 3.578769237354947*^9, {
   3.5787699477115774`*^9, 3.578769951151774*^9}, 3.5787709123040323`*^9, {
   3.5787761300831623`*^9, 3.5787761334581623`*^9}, {3.5787762304591618`*^9, 
   3.578776242861162*^9}, {3.578776454001162*^9, 3.5787764543001623`*^9}, {
   3.578776631878162*^9, 3.578776638325162*^9}, {3.5787766884801617`*^9, 
   3.5787767062151623`*^9}, 3.5787767621161623`*^9, 3.578776880931162*^9, {
   3.578776927595162*^9, 3.578776930582162*^9}, {3.578776971021162*^9, 
   3.578776978163162*^9}, 3.5787770259391623`*^9, {3.578777096757162*^9, 
   3.578777103809162*^9}, {3.578849145195913*^9, 3.578849149640913*^9}, {
   3.5788491875399127`*^9, 3.578849198579913*^9}, {3.5788492754079127`*^9, 
   3.5788493095169125`*^9}, {3.578849385834913*^9, 3.5788494022009125`*^9}, {
   3.578849501333913*^9, 3.578849545260913*^9}, {3.5788545546775484`*^9, 
   3.578854564783126*^9}, {3.578854630006857*^9, 3.5788546321169777`*^9}, {
   3.578855385895091*^9, 3.5788554326647663`*^9}, {3.578855503079794*^9, 
   3.5788555041348543`*^9}, {3.5788557247734737`*^9, 3.578855762388625*^9}, {
   3.5788558520967565`*^9, 3.5788558923260574`*^9}, {3.5790210873057876`*^9, 
   3.5790210884669037`*^9}, {3.5791018623119125`*^9, 3.579101880159832*^9}, {
   3.5791991406344357`*^9, 3.5791991448636775`*^9}, {3.5791994812479177`*^9, 
   3.579199483980074*^9}, 3.57920199720126*^9, {3.5792035309572163`*^9, 
   3.579203535790216*^9}, {3.579203656943334*^9, 3.579203659023126*^9}, {
   3.5792039677662177`*^9, 3.5792040164512177`*^9}, {3.5792040972312174`*^9, 
   3.5792041310702176`*^9}, {3.5792042859832177`*^9, 
   3.5792042862712173`*^9}, {3.5792043262732177`*^9, 
   3.5792043610422173`*^9}, {3.5792046313282175`*^9, 3.579204686881218*^9}, {
   3.5792048599072175`*^9, 3.5792048786152177`*^9}, 3.579205048013218*^9, {
   3.5792056775402174`*^9, 3.5792056796672173`*^9}, {3.5792057830942173`*^9, 
   3.5792057910292177`*^9}, {3.5792062472542176`*^9, 
   3.5792062474782176`*^9}, {3.579254693647725*^9, 3.5792546979009686`*^9}, {
   3.579254749309909*^9, 3.5792548107524233`*^9}, 3.5792549004925556`*^9, {
   3.57925499830315*^9, 3.579254998397156*^9}, {3.5792559914254346`*^9, 
   3.579256000158799*^9}, {3.579262653768672*^9, 3.579262658611672*^9}, 
   3.5793564753573794`*^9, {3.5793565931753798`*^9, 3.579356601487379*^9}, {
   3.5793568935933795`*^9, 3.5793569275083795`*^9}, 3.5793570978633795`*^9, {
   3.5793579628683796`*^9, 3.5793579646733794`*^9}, {3.5793581541813793`*^9, 
   3.5793581567133794`*^9}, {3.5797292217269564`*^9, 3.579729235390957*^9}, {
   3.5797300534159565`*^9, 3.5797300754279566`*^9}, {3.5797301225379567`*^9, 
   3.5797301947239566`*^9}, 3.5797350745399566`*^9, {3.579741555428481*^9, 
   3.5797415942033587`*^9}, 3.579741780684005*^9, 3.579743183838306*^9, 
   3.5797457176976666`*^9, {3.5839489064191*^9, 3.5839491251130996`*^9}, {
   3.5839491579020996`*^9, 3.5839492600990996`*^9}, {3.5839500180120993`*^9, 
   3.5839500690760994`*^9}, {3.5839501815500994`*^9, 3.5839502472731*^9}, {
   3.5839504177700996`*^9, 3.5839504383480997`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"inputTorque", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "g"}], " ", "M"}], "-", 
           FractionBox[
            RowBox[{"1.5`", " ", "contactForce"}], 
            SqrtBox[
             RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
              SuperscriptBox["Lc", "2"], "+", 
              RowBox[{"3.`", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["q", "1"], "]"}]}], "-", 
              RowBox[{"2", " ", "Lc", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 SubscriptBox["q", "1"], "-", 
                 SubscriptBox["q", "2"]}], "]"}]}], "-", 
              RowBox[{"3.`", " ", "Lc", " ", 
               RowBox[{"Cos", "[", 
                SubscriptBox["q", "2"], "]"}]}]}]]]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}]}], "+", 
        FractionBox[
         RowBox[{"contactForce", " ", "Lc", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "2"]}], "]"}]}], 
         SqrtBox[
          RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
           SuperscriptBox["Lc", "2"], "+", 
           RowBox[{"3.`", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "1"], "]"}]}], "-", 
           RowBox[{"2", " ", "Lc", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              SubscriptBox["q", "1"], "-", 
              SubscriptBox["q", "2"]}], "]"}]}], "-", 
           RowBox[{"3.`", " ", "Lc", " ", 
            RowBox[{"Cos", "[", 
             SubscriptBox["q", "2"], "]"}]}]}]]]}]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.`"}], " ", "contactForce", " ", "Lc", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "2"]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1.5`", " ", "contactForce", " ", "Lc"}], "-", 
            RowBox[{"1.`", " ", "g", " ", "M", " ", 
             SqrtBox[
              RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
               SuperscriptBox["Lc", "2"], "+", 
               RowBox[{"3.`", " ", 
                RowBox[{"Cos", "[", 
                 SubscriptBox["q", "1"], "]"}]}], "-", 
               RowBox[{"2", " ", "Lc", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                  SubscriptBox["q", "1"], "-", 
                  SubscriptBox["q", "2"]}], "]"}]}], "-", 
               RowBox[{"3.`", " ", "Lc", " ", 
                RowBox[{"Cos", "[", 
                 SubscriptBox["q", "2"], "]"}]}]}]]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           SubscriptBox["q", "2"], "]"}]}]}], 
        SqrtBox[
         RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
          SuperscriptBox["Lc", "2"], "+", 
          RowBox[{"3.`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "-", 
          RowBox[{"2", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"3.`", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}]]]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5839500337960997`*^9, 3.5839500696020994`*^9}, {
   3.5839501270701*^9, 3.5839501472150993`*^9}, {3.5839501835730996`*^9, 
   3.5839501872700996`*^9}, 3.5840151850254655`*^9, 3.5840190190897646`*^9, 
   3.5840224916267877`*^9, 3.5840225309637876`*^9, 3.585846223573457*^9, 
   3.5859173153832407`*^9, 3.585917740683869*^9, 3.5859182710539007`*^9, 
   3.586885365736868*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematic Points", "Section",
 CellChangeTimes->{{3.446936522284877*^9, 3.446936526233658*^9}, {
  3.482180100156204*^9, 3.4821801031942043`*^9}}],

Cell["These points will be used for plotting the robot in matlab", "Text",
 CellChangeTimes->{{3.4469366383944397`*^9, 3.446936650030229*^9}, {
   3.4821442962045727`*^9, 3.482144427222968*^9}, {3.4821444934081373`*^9, 
   3.482144572612027*^9}, {3.482144603216034*^9, 3.4821447118923025`*^9}, {
   3.4821458209270163`*^9, 3.482145874433955*^9}, {3.482180118674204*^9, 
   3.4821801373532043`*^9}, 3.5787552597654285`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pendulumOnePosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "pendulumOne", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pendulumOneVelocity", " ", "=", " ", 
   RowBox[{"VelCOM", "[", "pendulumOne", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"pendulumOne", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pendulumOneR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pendulumTwoPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "pendulumTwo", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pendulumTwoVelocity", " ", "=", " ", 
   RowBox[{"VelCOM", "[", "pendulumTwo", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"pendulumTwo", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pendulumTwoR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"contactPointOnCirclePosition", " ", "=", " ", 
  RowBox[{
  "PosCOM", "[", "pendulumTwoContactPointOnCircle", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"contactPointOnCircleVelocity", " ", "=", " ", 
   RowBox[{"VelCOM", "[", "pendulumTwoContactPointOnCircle", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"pendulumTwoContactPointOnCircle", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"contactPointOnCircleR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pendulumOneContactPointPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "pendulumOneContactPoint", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pendulumTwoContactCircleCenterPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "pendulumTwoContactCircleCenter", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.446935543679307*^9, 3.446935599122636*^9}, {
   3.446935808059744*^9, 3.446935857823979*^9}, {3.446935929982038*^9, 
   3.446935951548718*^9}, {3.4469361242103558`*^9, 3.4469361388641233`*^9}, {
   3.4471108208344097`*^9, 3.44711084481641*^9}, 3.44711090527741*^9, {
   3.482142931321968*^9, 3.482142931321968*^9}, {3.4821447524906797`*^9, 
   3.482144771528054*^9}, {3.4821452640362463`*^9, 3.482145342809517*^9}, {
   3.482180166634204*^9, 3.482180241325204*^9}, {3.4821804823242044`*^9, 
   3.482180522189204*^9}, {3.4821805535632043`*^9, 3.482180669773204*^9}, {
   3.482181021981204*^9, 3.482181089575204*^9}, {3.4821812127322044`*^9, 
   3.482181225667204*^9}, {3.482181265289204*^9, 3.482181369539204*^9}, {
   3.4821818544702044`*^9, 3.482181870433204*^9}, {3.4821819669452043`*^9, 
   3.482182080349204*^9}, {3.4821821181352043`*^9, 3.4821821955762043`*^9}, {
   3.482182236735204*^9, 3.482182308554204*^9}, {3.4821837717652044`*^9, 
   3.482183804309204*^9}, {3.4821838841922045`*^9, 3.4821838896952043`*^9}, {
   3.482183955052204*^9, 3.482184017236204*^9}, {3.4821840489872046`*^9, 
   3.4821840714092045`*^9}, {3.4821846973782043`*^9, 
   3.4821846977912045`*^9}, {3.482187446781204*^9, 3.482187462605204*^9}, {
   3.482187504132204*^9, 3.4821875923782043`*^9}, {3.4821880850812044`*^9, 
   3.482188166834204*^9}, {3.4821882190412045`*^9, 3.4821882199492044`*^9}, 
   3.4821882775602045`*^9, {3.4821884972062044`*^9, 3.482188514183204*^9}, {
   3.4821905998062043`*^9, 3.482190617679204*^9}, {3.482190789973204*^9, 
   3.4821908211612043`*^9}, {3.4823344128998117`*^9, 
   3.4823344531318116`*^9}, {3.4824328743230295`*^9, 3.482432879268029*^9}, {
   3.482443227091878*^9, 3.482443230695238*^9}, {3.4832152405788307`*^9, 
   3.4832152450552225`*^9}, {3.578755431429428*^9, 3.5787554404574285`*^9}, {
   3.5787554860974283`*^9, 3.5787554916364284`*^9}, {3.5787563081354284`*^9, 
   3.5787563569994287`*^9}, {3.578756660995161*^9, 3.57875674958702*^9}, {
   3.5787574844024234`*^9, 3.578757498733423*^9}, {3.5787576269964237`*^9, 
   3.5787576286604233`*^9}, {3.578757901334423*^9, 3.5787579916244235`*^9}, {
   3.5787596272274237`*^9, 3.5787596465214233`*^9}, {3.57876353976799*^9, 
   3.5787635523512487`*^9}, 3.578763660234418*^9, {3.578839538771937*^9, 
   3.578839539678937*^9}, 3.579202015465086*^9, {3.5792022435822163`*^9, 
   3.579202251282216*^9}, {3.579202305705216*^9, 3.579202313871216*^9}, {
   3.579203675764452*^9, 3.5792036770753207`*^9}, {3.579257165245838*^9, 
   3.5792571716144753`*^9}, {3.579281285925775*^9, 3.579281293326515*^9}, {
   3.579349699520104*^9, 3.57934970696553*^9}, {3.579349909798131*^9, 
   3.579349909965141*^9}, {3.5793499608000484`*^9, 3.5793499771499834`*^9}, {
   3.57935000785474*^9, 3.5793500599017167`*^9}, {3.5793500933596306`*^9, 
   3.5793501376311626`*^9}, {3.5793501749993*^9, 3.5793502061170797`*^9}, {
   3.5793502418741245`*^9, 3.579350265878498*^9}, {3.5793503765098257`*^9, 
   3.5793504584995155`*^9}, {3.579350501631982*^9, 3.5793505055032034`*^9}, {
   3.5793505358169374`*^9, 3.5793505622174473`*^9}, {3.5793567277543793`*^9, 
   3.579356796143379*^9}, 3.5793568778753796`*^9, {3.5793591773423796`*^9, 
   3.5793591788803797`*^9}, {3.579359226223379*^9, 3.5793592265903797`*^9}, {
   3.5793592644303794`*^9, 3.579359270237379*^9}, {3.579624073420703*^9, 
   3.5796241177341337`*^9}, {3.57963650253049*^9, 3.579636513501587*^9}, {
   3.579730201350957*^9, 3.5797302253289566`*^9}, {3.5839504681140995`*^9, 
   3.5839505358840995`*^9}, {3.5839506249630995`*^9, 3.5839506375631*^9}, {
   3.5839557085771*^9, 3.5839558274200993`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"-", 
    FractionBox[
     RowBox[{"contactCircleRadius", " ", 
      SubscriptBox[
       UnderscriptBox["pendulumOne", "_"], "3"]}], 
     SqrtBox[
      RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
       SuperscriptBox["Lc", "2"], "+", 
       RowBox[{"3.`", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "1"], "]"}]}], "-", 
       RowBox[{"2", " ", "Lc", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          SubscriptBox["q", "1"], "-", 
          SubscriptBox["q", "2"]}], "]"}]}], "-", 
       RowBox[{"3.`", " ", "Lc", " ", 
        RowBox[{"Cos", "[", 
         SubscriptBox["q", "2"], "]"}]}]}]]]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.5`", "\[VeryThinSpace]", "-", 
      FractionBox[
       RowBox[{"1.5`", " ", "contactCircleRadius"}], 
       SqrtBox[
        RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
         SuperscriptBox["Lc", "2"], "+", 
         RowBox[{"3.`", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "1"], "]"}]}], "-", 
         RowBox[{"2", " ", "Lc", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "2"]}], "]"}]}], "-", 
         RowBox[{"3.`", " ", "Lc", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}]}]]]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["ground", "_"], "3"]}],
   HoldForm], "+", 
  TagBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "Lc"}], "+", 
      FractionBox[
       RowBox[{"contactCircleRadius", " ", "Lc"}], 
       SqrtBox[
        RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
         SuperscriptBox["Lc", "2"], "+", 
         RowBox[{"3.`", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "1"], "]"}]}], "-", 
         RowBox[{"2", " ", "Lc", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            SubscriptBox["q", "1"], "-", 
            SubscriptBox["q", "2"]}], "]"}]}], "-", 
         RowBox[{"3.`", " ", "Lc", " ", 
          RowBox[{"Cos", "[", 
           SubscriptBox["q", "2"], "]"}]}]}]]]}], ")"}], " ", 
    SubscriptBox[
     UnderscriptBox["pendulumTwo", "_"], "3"]}],
   HoldForm]}]], "Output",
 CellChangeTimes->{{3.5839558083230996`*^9, 3.5839558279960995`*^9}, 
   3.5840151851486254`*^9, 3.584019019139759*^9, 3.584022491670788*^9, 
   3.5840225310067873`*^9, 3.585846223680463*^9, 3.585917315456277*^9, 
   3.585917740730873*^9, 3.585918271099905*^9, 3.586885365946889*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraint equations", "Section",
 CellChangeTimes->{{3.446936522284877*^9, 3.446936526233658*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"contactVelocity", " ", "=", " ", 
    RowBox[{
     RowBox[{"VelCOM", "[", "pendulumTwoContactPointOnCircle", "]"}], " ", 
     "-", " ", 
     RowBox[{"VelCOM", "[", "pendulumOneContactPoint", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allVelocityVariables", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], ",", 
      RowBox[{"u", "[", "2", "]"}]}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"u", "[", "3", "]"}], ",", 
       RowBox[{"u", "[", "4", "]"}], ",", 
       RowBox[{"u", "[", "5", "]"}], ",", 
       RowBox[{"u", "[", "6", "]"}], ",", 
       RowBox[{"u", "[", "7", "]"}], ",", 
       RowBox[{"u", "[", "8", "]"}], ",", 
       RowBox[{"u", "[", "9", "]"}], ",", 
       RowBox[{"u", "[", "10", "]"}]}], "*)"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constraintJacobianContact", "=", "\[IndentingNewLine]", 
    RowBox[{"LinearTerms", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "contactVelocity", ".", "circleSurfaceToContactPointDirection"}], " ", 
       "\[IndentingNewLine]", "}"}], ",", "allVelocityVariables"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"definitionsOfQDots", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "1", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "1", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "2", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "2", "]"}]}], " ", ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "3", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "3", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "4", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "4", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "5", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "5", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "6", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "6", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "7", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "7", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "8", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "8", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "9", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "9", "]"}]}]}], 
     RowBox[{"(*", 
      RowBox[{",", " ", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"q", "[", "10", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
        RowBox[{"u", "[", "10", "]"}]}]}], "*)"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constraintJacobianContactDot", " ", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"constraintJacobianContact", ",", " ", "t"}], "]"}], " ", "//.",
      " ", "definitionsOfQDots"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"positive", " ", "means", " ", "no", " ", "contact"}], ",", " ", 
    RowBox[{"zero", " ", "means", " ", "contact"}], ",", " ", 
    RowBox[{"negative", " ", "is", " ", "illegal"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nonPenetrationConstraint", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PosCOM", "[", "pendulumOneContactPoint", "]"}], " ", "-", 
        " ", 
        RowBox[{"PosCOM", "[", "pendulumTwoContactPointOnCircle", "]"}]}], 
       ")"}], ".", "circleSurfaceToContactPointDirection"}], " ", "//", " ", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "constraintJacobianContact", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MatrixForm", "[", "nonPenetrationConstraint", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446935543679307*^9, 3.446935599122636*^9}, {
   3.446935808059744*^9, 3.446935857823979*^9}, {3.446935929982038*^9, 
   3.446935951548718*^9}, {3.4469361242103558`*^9, 3.4469361388641233`*^9}, {
   3.4471108208344097`*^9, 3.44711084481641*^9}, 3.44711090527741*^9, {
   3.482142931321968*^9, 3.482142931321968*^9}, {3.4821447524906797`*^9, 
   3.482144771528054*^9}, {3.4821452640362463`*^9, 3.482145342809517*^9}, {
   3.5787590362604237`*^9, 3.5787590724174232`*^9}, {3.5787593340984235`*^9, 
   3.5787593713944235`*^9}, {3.5787596681784234`*^9, 
   3.5787596736464233`*^9}, {3.5787597811644235`*^9, 
   3.5787598257564235`*^9}, {3.5787604267107153`*^9, 3.57876043715776*^9}, {
   3.5787607697480164`*^9, 3.578760773140355*^9}, {3.5787608203900795`*^9, 
   3.5787608208221226`*^9}, {3.57876095380542*^9, 3.5787609579818373`*^9}, {
   3.578761118884926*^9, 3.5787611199720345`*^9}, {3.5787611569027276`*^9, 
   3.5787611632543626`*^9}, {3.5787612889719334`*^9, 
   3.5787612892439604`*^9}, {3.5787613762876635`*^9, 3.5787613776307983`*^9}, 
   3.578762143840411*^9, {3.5788541174405394`*^9, 3.578854133551461*^9}, 
   3.5788544271042514`*^9, 3.579114165622105*^9, {3.5791145288481054`*^9, 
   3.5791145537421055`*^9}, 3.5791145998831053`*^9, {3.5792583386621685`*^9, 
   3.5792583390932117`*^9}, {3.579359330844447*^9, 3.579359386652184*^9}, {
   3.5793594237012954`*^9, 3.5793594351117177`*^9}, {3.579359486789216*^9, 
   3.579359530542338*^9}, {3.5793596241143928`*^9, 3.579359633027175*^9}, {
   3.5839506519080997`*^9, 3.5839507289650993`*^9}, {3.5839507904591*^9, 
   3.5839508011930995`*^9}, {3.5839509005460997`*^9, 
   3.5839509186000996`*^9}, {3.5839509694560995`*^9, 
   3.5839509704940996`*^9}, {3.5839511313360996`*^9, 
   3.5839512271210995`*^9}, {3.5839514787170997`*^9, 
   3.5839514965520997`*^9}, {3.5839515451440997`*^9, 3.5839515772941*^9}, {
   3.5839516111790996`*^9, 3.5839516575701*^9}, 3.5839518958220997`*^9, {
   3.5839558561320996`*^9, 3.5839560381490993`*^9}, {3.5839572204950995`*^9, 
   3.5839573229960995`*^9}, 3.583971200131362*^9, {3.583974915827894*^9, 
   3.5839749541607275`*^9}, {3.583974992081519*^9, 3.5839750233156424`*^9}, {
   3.5839751310814176`*^9, 3.5839751385671663`*^9}, {3.583975182336542*^9, 
   3.5839751829075994`*^9}, {3.5839752132726355`*^9, 
   3.5839752742177296`*^9}, {3.5839753372400312`*^9, 
   3.5839753420235095`*^9}, {3.583975555706876*^9, 3.583975575540859*^9}, {
   3.5840150702764854`*^9, 3.584015073238331*^9}, {3.5840151424632063`*^9, 
   3.584015162970832*^9}, {3.584017696252516*^9, 3.5840177120790977`*^9}, {
   3.584017783616251*^9, 3.584017817653654*^9}, {3.5858461965969133`*^9, 
   3.5858462066754904`*^9}, {3.585893730030403*^9, 3.5858937316384954`*^9}, 
   3.585915875872823*^9, {3.5859185970574975`*^9, 3.585918597463538*^9}, 
   3.5868853351948137`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"1.5`", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "1"], "]"}]}], 
        SqrtBox[
         RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
          SuperscriptBox["Lc", "2"], "+", 
          RowBox[{"3.`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "-", 
          RowBox[{"2", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"3.`", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}]]], "-", 
       FractionBox[
        RowBox[{"Lc", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], 
        SqrtBox[
         RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
          SuperscriptBox["Lc", "2"], "+", 
          RowBox[{"3.`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "-", 
          RowBox[{"2", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"3.`", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}]]]}], 
      RowBox[{
       FractionBox[
        RowBox[{"Lc", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           SubscriptBox["q", "1"], "-", 
           SubscriptBox["q", "2"]}], "]"}]}], 
        SqrtBox[
         RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
          SuperscriptBox["Lc", "2"], "+", 
          RowBox[{"3.`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "-", 
          RowBox[{"2", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"3.`", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}]]], "-", 
       FractionBox[
        RowBox[{"1.5`", " ", "Lc", " ", 
         RowBox[{"Sin", "[", 
          SubscriptBox["q", "2"], "]"}]}], 
        SqrtBox[
         RowBox[{"3.25`", "\[VeryThinSpace]", "+", 
          SuperscriptBox["Lc", "2"], "+", 
          RowBox[{"3.`", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "1"], "]"}]}], "-", 
          RowBox[{"2", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             SubscriptBox["q", "1"], "-", 
             SubscriptBox["q", "2"]}], "]"}]}], "-", 
          RowBox[{"3.`", " ", "Lc", " ", 
           RowBox[{"Cos", "[", 
            SubscriptBox["q", "2"], "]"}]}]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5839558952320995`*^9, 3.5839559024191*^9}, {
   3.5839559396031*^9, 3.5839559832310996`*^9}, {3.5839572791741*^9, 
   3.5839573408590994`*^9}, 3.583971285729921*^9, 3.5839750183071413`*^9, {
   3.583975231667475*^9, 3.583975249511259*^9}, 3.5840151431971593`*^9, 
   3.5840151852057*^9, {3.5840176965815487`*^9, 3.5840177204539356`*^9}, 
   3.584017818748764*^9, 3.584019019675706*^9, 3.5840224921107874`*^9, 
   3.584022531328788*^9, {3.5858462080625696`*^9, 3.5858462242404947`*^9}, 
   3.5858937353657084`*^9, 3.5859173159435205`*^9, 3.5859177411899195`*^9, 
   3.585918271740969*^9, 3.5868853667239666`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export expressions in Matlab format", "Section",
 CellChangeTimes->{{3.446937222052465*^9, 3.4469372272078342`*^9}, {
  3.4479795986645265`*^9, 3.4479796140455265`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"inGroundFrame", "[", "v_", "]"}], " ", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "1", "]"}]}], ",", " ", 
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "3", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expressionsToExport", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianContact", ",", 
         "\"\<constraintJacobianContact\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianContactDot", ",", 
         "\"\<constraintJacobianContactDot\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "nonPenetrationConstraint", ",", "\"\<nonPenetrationConstraint\>\""}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"PE", ",", " ", "\"\<energies.PE\>\""}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"PEGravity", ",", " ", "\"\<energies.PEGravity\>\""}], "}"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"KE", ",", " ", "\"\<energies.KE\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "pendulumOnePosition", "]"}], ",", 
         "\"\<points.pendulumOne.position\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "pendulumOneVelocity", "]"}], ",", 
         "\"\<points.pendulumOne.velocity\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pendulumOneR", ",", "\"\<points.pendulumOne.R\>\""}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "pendulumTwoPosition", "]"}], ",", 
         "\"\<points.pendulumTwo.position\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "pendulumTwoVelocity", "]"}], ",", 
         "\"\<points.pendulumTwo.velocity\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pendulumTwoR", ",", "\"\<points.pendulumTwo.R\>\""}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "contactPointOnCirclePosition", "]"}], 
         ",", "\"\<points.contactPointOnCircle.position\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "contactPointOnCircleVelocity", "]"}], 
         ",", "\"\<points.contactPointOnCircle.velocity\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "contactPointOnCircleR", ",", 
         "\"\<points.contactPointOnCircle.R\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "inGroundFrame", "[", "pendulumOneContactPointPosition", "]"}], ",", 
         "\"\<points.pendulumOneContactPointPosition\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "inGroundFrame", "[", "pendulumTwoContactCircleCenterPosition", 
          "]"}], ",", 
         "\"\<points.pendulumTwoContactCircleCenterPosition\>\""}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "inGroundFrame", "[", "circleSurfaceToContactPointDirection", "]"}], 
         ",", " ", "\"\<points.circleSurfaceToContactPointDirection\>\""}], 
        "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.482161321647367*^9, 3.482161356313833*^9}, {
   3.482161933457542*^9, 3.4821619485240483`*^9}, {3.4821716004951487`*^9, 
   3.482171738958994*^9}, {3.482171816804778*^9, 3.4821718333504324`*^9}, {
   3.482171872483345*^9, 3.4821719113702335`*^9}, {3.482172142339328*^9, 
   3.4821721464427385`*^9}, {3.4821734981882854`*^9, 
   3.4821734986218514`*^9}, {3.482181382900204*^9, 3.4821813951072044`*^9}, {
   3.482181602363204*^9, 3.482181604707204*^9}, {3.482181648657204*^9, 
   3.4821816517772045`*^9}, {3.482181880507204*^9, 3.482181912019204*^9}, {
   3.482182418028204*^9, 3.4821824209372044`*^9}, {3.4821850598172045`*^9, 
   3.482185088046204*^9}, {3.4821877332722044`*^9, 3.4821877377212043`*^9}, {
   3.482187988526204*^9, 3.4821879892742043`*^9}, {3.4832194606125956`*^9, 
   3.483219538704887*^9}, {3.4832198142010307`*^9, 3.48321981863741*^9}, {
   3.483298486402483*^9, 3.483298492461195*^9}, {3.490230651193972*^9, 
   3.490230680516904*^9}, {3.490291405300268*^9, 3.4902914138815565`*^9}, {
   3.490291726710726*^9, 3.490291738343052*^9}, {3.4902918081690145`*^9, 
   3.4902918110245857`*^9}, {3.4902962380450835`*^9, 
   3.4902962742567043`*^9}, {3.490300279283167*^9, 3.490300312386477*^9}, {
   3.4913052765617933`*^9, 3.4913052770424848`*^9}, {3.4913161334512653`*^9, 
   3.4913161961113663`*^9}, {3.491316239493747*^9, 3.4913162630976877`*^9}, {
   3.491317267371763*^9, 3.4913173241834545`*^9}, {3.491317748814043*^9, 
   3.491317753170307*^9}, {3.578762227373764*^9, 3.5787622332113476`*^9}, {
   3.5787622912061462`*^9, 3.578762306510677*^9}, {3.578762349940019*^9, 
   3.578762426615686*^9}, {3.578762458950919*^9, 3.578762659546977*^9}, {
   3.5787627506420856`*^9, 3.5787628165306735`*^9}, {3.578762848244845*^9, 
   3.578762854070427*^9}, {3.578763094001418*^9, 3.578763164821499*^9}, {
   3.5787632736103773`*^9, 3.578763291900206*^9}, {3.5787633410511203`*^9, 
   3.578763369402955*^9}, {3.57876347226024*^9, 3.5787635048655005`*^9}, {
   3.578763561589172*^9, 3.5787635634463577`*^9}, {3.578765984405405*^9, 
   3.578765988275626*^9}, {3.578766018876377*^9, 3.5787660271248484`*^9}, {
   3.57877030844621*^9, 3.578770309599276*^9}, {3.578770700749648*^9, 
   3.5787707126013265`*^9}, {3.578772543460771*^9, 3.578772559927771*^9}, 
   3.578772593390771*^9, {3.578772753504771*^9, 3.5787728165287714`*^9}, {
   3.578772849769771*^9, 3.578772858386771*^9}, {3.5787730255927715`*^9, 
   3.5787730333167715`*^9}, {3.5787734959317713`*^9, 3.578773522202771*^9}, {
   3.5787735973447714`*^9, 3.5787735980617714`*^9}, {3.5787746301550407`*^9, 
   3.578774631293268*^9}, {3.5787747382566566`*^9, 3.5787747393938847`*^9}, {
   3.578775500850464*^9, 3.5787755034077196`*^9}, {3.578775544172796*^9, 
   3.5787755689472733`*^9}, 3.5787756794223194`*^9, {3.578775786509162*^9, 
   3.5787757865901623`*^9}, {3.5787758713811617`*^9, 3.578775917345162*^9}, {
   3.578776171799162*^9, 3.5787761770581617`*^9}, 3.578777791535162*^9, {
   3.578839850768937*^9, 3.5788398612629366`*^9}, {3.578839898779937*^9, 
   3.578839901883937*^9}, {3.5788560078346643`*^9, 3.578856009913783*^9}, {
   3.578856500202826*^9, 3.578856510491414*^9}, {3.579258866743971*^9, 
   3.579258870712368*^9}, {3.5796213107484636`*^9, 3.5796213180421925`*^9}, {
   3.579627390577386*^9, 3.579627392557584*^9}, 3.5796365445106874`*^9, {
   3.5797302506199565`*^9, 3.579730269694957*^9}, {3.5797343443849564`*^9, 
   3.5797343488559566`*^9}, {3.5839573755680995`*^9, 3.5839574630640993`*^9}, 
   3.583970049685607*^9, {3.5839702895093975`*^9, 3.583970320210939*^9}, {
   3.5839705925567727`*^9, 3.5839706243553095`*^9}, {3.583970675567669*^9, 
   3.5839707225537605`*^9}, {3.5840151204115763`*^9, 
   3.5840151285751753`*^9}, {3.58591771109591*^9, 3.585917727958596*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExportCode", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
    RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
    
    RowBox[{"OutputFile", "\[Rule]", "outputFile"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ExportCode", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
     RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
     RowBox[{
     "OutputFile", "->", 
      "\"\<C:\\\\Users\\\\hbclStudent\\\\Documents\\\\mathematicaOutput.m\>\"\
"}]}], "]"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"ExportCode", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
     RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
     RowBox[{
     "OutputFile", "->", 
      "\"\<D:\\\\myProjects\\\\SpringyWalking\\\\mathematica models from \
kishore\\\\springyWalkerWithKnees\\\\mathemticaOutput.m\>\""}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.447585536668432*^9, 3.447585549638657*^9}, {
   3.44759301796579*^9, 3.447593018875005*^9}, {3.482171540061106*^9, 
   3.4821715907761774`*^9}, {3.483289839649062*^9, 3.4832898504245567`*^9}, {
   3.483289935587014*^9, 3.4832899395427027`*^9}, {3.4844722124239798`*^9, 
   3.484472215151136*^9}, {3.491316324455917*^9, 3.4913163383959618`*^9}, {
   3.5787608391449547`*^9, 3.5787608420552464`*^9}, {3.5787622379098177`*^9, 
   3.5787622408041067`*^9}, {3.5787622717562017`*^9, 3.578762273159342*^9}, {
   3.578769783680195*^9, 3.578769789036502*^9}, {3.5787700002545824`*^9, 
   3.578770003491768*^9}, {3.578770609360421*^9, 3.5787706383740807`*^9}, {
   3.5787708776798983`*^9, 3.578770878098274*^9}, {3.5787721037493296`*^9, 
   3.5787721057515297`*^9}, 3.578772745741771*^9, {3.578777775412162*^9, 
   3.578777782107162*^9}, 3.5788395181229367`*^9, {3.5788583953302207`*^9, 
   3.5788583964652863`*^9}, {3.579280776269*^9, 3.579280778133373*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Opening file \\\"\"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\Branches\\\\\
jrebula\\\\ThreeDWalker\\\\trajectoryOptimization\\\\\
directConstraintOptimization\\\\basicTest\\\\mathematicaOutput.m\"\>", 
   "\[InvisibleSpace]", "\<\"\\\"\"\>"}],
  SequenceForm[
  "Opening file \"", 
   "C:\\Users\\hbclStudent\\workspace\\dynamicWalking\\Branches\\jrebula\\\
ThreeDWalker\\trajectoryOptimization\\directConstraintOptimization\\basicTest\
\\mathematicaOutput.m", "\""],
  Editable->False]], "Print",
 CellChangeTimes->{3.5797432353874607`*^9, 3.5797434443683567`*^9, 
  3.579745229501852*^9, 3.5797455542503233`*^9, 3.579745772975194*^9, 
  3.5797714680287285`*^9, 3.5797719378438115`*^9, 3.579772105585688*^9, 
  3.5840151857393923`*^9, 3.584019019771696*^9, 3.584022492175788*^9, 
  3.5840225313747873`*^9, 3.5858462243715024`*^9, 3.585917316125612*^9, 
  3.5859177413499355`*^9, 3.585918271886984*^9, 3.5868853669169855`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Current directory: \"\>", 
   "\[InvisibleSpace]", "\<\"C:\\\\Users\\\\hbclStudent\\\\Documents\"\>"}],
  SequenceForm["Current directory: ", "C:\\Users\\hbclStudent\\Documents"],
  Editable->False]], "Print",
 CellChangeTimes->{3.5797432353874607`*^9, 3.5797434443683567`*^9, 
  3.579745229501852*^9, 3.5797455542503233`*^9, 3.579745772975194*^9, 
  3.5797714680287285`*^9, 3.5797719378438115`*^9, 3.579772105585688*^9, 
  3.5840151857393923`*^9, 3.584019019771696*^9, 3.584022492175788*^9, 
  3.5840225313747873`*^9, 3.5858462243715024`*^9, 3.585917316125612*^9, 
  3.5859177413499355`*^9, 3.585918271886984*^9, 3.586885366920986*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Closing file \\\"\"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\Branches\\\\\
jrebula\\\\ThreeDWalker\\\\trajectoryOptimization\\\\\
directConstraintOptimization\\\\basicTest\\\\mathematicaOutput.m\"\>", 
   "\[InvisibleSpace]", "\<\"\\\"\"\>"}],
  SequenceForm[
  "Closing file \"", 
   "C:\\Users\\hbclStudent\\workspace\\dynamicWalking\\Branches\\jrebula\\\
ThreeDWalker\\trajectoryOptimization\\directConstraintOptimization\\basicTest\
\\mathematicaOutput.m", "\""],
  Editable->False]], "Print",
 CellChangeTimes->{3.5797432353874607`*^9, 3.5797434443683567`*^9, 
  3.579745229501852*^9, 3.5797455542503233`*^9, 3.579745772975194*^9, 
  3.5797714680287285`*^9, 3.5797719378438115`*^9, 3.579772105585688*^9, 
  3.5840151857393923`*^9, 3.584019019771696*^9, 3.584022492175788*^9, 
  3.5840225313747873`*^9, 3.5858462243715024`*^9, 3.585917316125612*^9, 
  3.5859177413499355`*^9, 3.585918271886984*^9, 3.586885367041998*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 314, 4, 90, "Title"],
Cell[884, 28, 1957, 40, 272, "Input"],
Cell[CellGroupData[{
Cell[2866, 72, 103, 1, 79, "Section"],
Cell[CellGroupData[{
Cell[2994, 77, 549, 7, 34, "Subsubsection"],
Cell[CellGroupData[{
Cell[3568, 88, 15255, 282, 592, "Input"],
Cell[18826, 372, 72, 1, 31, "Output"],
Cell[18901, 375, 72, 1, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19022, 382, 358, 4, 34, "Subsubsection"],
Cell[CellGroupData[{
Cell[19405, 390, 8151, 169, 632, "Input"],
Cell[27559, 561, 4408, 112, 155, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32028, 680, 152, 2, 79, "Section"],
Cell[32183, 684, 422, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[32630, 693, 9647, 219, 472, "Input"],
Cell[42280, 914, 2558, 73, 121, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44887, 993, 105, 1, 79, "Section"],
Cell[CellGroupData[{
Cell[45017, 998, 7516, 167, 432, "Input"],
Cell[52536, 1167, 4025, 103, 71, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56610, 1276, 175, 2, 79, "Section"],
Cell[56788, 1280, 7738, 152, 432, "Input"],
Cell[CellGroupData[{
Cell[64551, 1436, 2163, 44, 132, "Input"],
Cell[CellGroupData[{
Cell[66739, 1484, 1031, 19, 23, "Print"],
Cell[67773, 1505, 685, 11, 23, "Print"],
Cell[68461, 1518, 1029, 19, 23, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
