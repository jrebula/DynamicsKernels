(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    105661,       2302]
NotebookOptionsPosition[    102674,       2204]
NotebookOutlinePosition[    103117,       2221]
CellTagsIndexPosition[    103074,       2218]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["3D wallker with splayed legs and torso (as constants)", "Title",
 CellChangeTimes->{{3.446917747848176*^9, 3.446917769908661*^9}, {
  3.4821408156397667`*^9, 3.4821408172821283`*^9}, {3.5787504167873793`*^9, 
  3.5787504649171915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<DynamicsWorkbench`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.446934412694668*^9, 3.4469344189176893`*^9}, {
  3.578516528511217*^9, 3.578516529344217*^9}, {3.5785166544342165`*^9, 
  3.578516694146217*^9}}],

Cell[CellGroupData[{

Cell["Equations of motion", "Section",
 CellChangeTimes->{{3.44693654093233*^9, 3.446936542796586*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewModel", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.446933798487845*^9, 3.4469338643521357`*^9}, {
   3.446933973115541*^9, 3.446933973964518*^9}, {3.446934165197138*^9, 
   3.446934196255003*^9}, {3.446934232495329*^9, 3.446934296806625*^9}, {
   3.4469343369097557`*^9, 3.446934396401021*^9}, {3.446934874977736*^9, 
   3.446934894293985*^9}, {3.44693499207298*^9, 3.446935146273335*^9}, {
   3.44693525471518*^9, 3.446935466215646*^9}, {3.446935962145954*^9, 
   3.446935976732356*^9}, {3.446936070668562*^9, 3.44693608258097*^9}, 
   3.4469363147903633`*^9, {3.482140849758827*^9, 3.482140852963435*^9}}],

Cell[CellGroupData[{

Cell["\<\
Pelvis is in mid-air, defined by x, y, z and roll angle (q1-4)\
\>", "Subsubsection",
 CellChangeTimes->{{3.446936318237425*^9, 3.446936330297329*^9}, {
  3.578749977859491*^9, 3.5787500010568104`*^9}, {3.5787544859174285`*^9, 
  3.5787544869124284`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pelvisX", ",", "ground", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "1", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "1"}], ",", 
    RowBox[{"Udof", "\[Rule]", "1"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pelvisY", ",", "pelvisX", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "2"}], ",", 
    RowBox[{"Udof", "\[Rule]", "2"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pelvisZ", ",", "pelvisY", ",", "Slider", ",", 
    RowBox[{"TAxis", "\[Rule]", 
     RowBox[{"ground", "[", "3", "]"}]}], ",", 
    RowBox[{"Qdof", "\[Rule]", "3"}], ",", 
    RowBox[{"Udof", "\[Rule]", "3"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"pelvis", ",", "pelvisZ", ",", "Hinge", ",", 
    RowBox[{"Axis", "\[Rule]", 
     RowBox[{"ground", "[", "1", "]"}]}], ",", 
    RowBox[{"Mass", "\[Rule]", "MPelvis"}], ",", " ", 
    RowBox[{"Inertia", " ", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{"IPelvis", ",", " ", "0", ",", " ", "0"}], "}"}]}], ",", " ", 
    RowBox[{"Qdof", "\[Rule]", "4"}], ",", 
    RowBox[{"Udof", "\[Rule]", "4"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.446933798487845*^9, 3.4469338643521357`*^9}, {
  3.446933973115541*^9, 3.446933973964518*^9}, {3.446934165197138*^9, 
  3.446934196255003*^9}, {3.446934232495329*^9, 3.446934296806625*^9}, {
  3.4469343369097557`*^9, 3.446934396401021*^9}, {3.446934874977736*^9, 
  3.446934894293985*^9}, {3.44693499207298*^9, 3.446935146273335*^9}, {
  3.44693525471518*^9, 3.446935466215646*^9}, {3.446935962145954*^9, 
  3.446935976732356*^9}, {3.446936070668562*^9, 3.44693608258097*^9}, {
  3.4469363147903633`*^9, 3.446936338677568*^9}, {3.447108730431511*^9, 
  3.4471087326552887`*^9}, {3.448102564783743*^9, 3.448102565727837*^9}, {
  3.5787500849351974`*^9, 3.5787503216168633`*^9}, {3.578750849930689*^9, 
  3.5787508534830446`*^9}, {3.5787522957910376`*^9, 3.5787522968470373`*^9}, {
  3.5787568079688573`*^9, 3.5787568101420746`*^9}, {3.5787614961356473`*^9, 
  3.5787615098000135`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Stance and swing legs rotate about pelvis in sagittal plane (pitch) (q5, q6)\
\>", "Subsubsection",
 CellChangeTimes->{{3.4469363466535482`*^9, 3.446936373878829*^9}, {
  3.482141165062211*^9, 3.482141167065091*^9}, {3.578750332894991*^9, 
  3.578750374561157*^9}, {3.5787505538650856`*^9, 3.57875055490919*^9}}],

Cell["\<\
The legs rotate about the y axis, making the hip joint and its control \
somewhat interesting. We get to ignore that, and claim that a person can use \
muscles to make it so. These are implemented as massless hinge joints with \
massful fixed joints attached that represent the strange inertias of the \
splayed legs. Feet are cylinders about the y axis with radius R\
\>", "Text",
 CellChangeTimes->{{3.5787505734660454`*^9, 3.5787505873274317`*^9}, {
   3.5787506610208*^9, 3.578750668797578*^9}, {3.5787507340000973`*^9, 
   3.578750770513748*^9}, {3.5787514679880376`*^9, 3.5787515009490376`*^9}, 
   3.5787517523110375`*^9, {3.5787568374848084`*^9, 3.5787568642214823`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stanceLegSplayRotation", " ", "=", " ", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"splayAngle", ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swingLegSplayRotation", " ", "=", " ", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"-", "splayAngle"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", " ", "0", ",", " ", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stanceLegMassOffsetVector", " ", "=", " ", 
   RowBox[{
    RowBox[{"legMassVerticalOffset", " ", 
     RowBox[{"stanceLeg", "[", "3", "]"}]}], "-", 
    RowBox[{"legMassForwardOffset", " ", 
     RowBox[{"stanceLeg", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{
   "stanceLegJoint", ",", " ", "pelvis", ",", " ", "Hinge", ",", " ", 
    RowBox[{"Axis", "->", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"RelativeTo", "\[Rule]", "ground"}], ",", " ", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pelvisWidth", "/", "2"}], " ", ")"}], 
      RowBox[{"pelvis", "[", "2", "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"stanceLeg", ",", " ", "stanceLegJoint", ",", " ", "Fixed", ",", 
    RowBox[{"Offset", " ", "\[Rule]", " ", "stanceLegSplayRotation"}], ",", 
    RowBox[{"Mass", "\[Rule]", "MLeg"}], ",", 
    RowBox[{"Inertia", "->", 
     RowBox[{"{", 
      RowBox[{"ILeg", ",", "ILeg", ",", " ", "0"}], "}"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "stanceLegMassOffsetVector"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"stanceFoot", ",", " ", "stanceLeg", ",", " ", "Fixed", ",", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{"stanceLegMassOffsetVector", " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"L", " ", "-", "R"}], ")"}], " ", 
       RowBox[{"stanceLeg", "[", "3", "]"}]}]}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "0"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddBody", "[", 
    RowBox[{
    "stanceContactPoint", ",", " ", "stanceFoot", ",", " ", "Fixed", ",", 
     RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
     RowBox[{"BodyToJnt", "\[Rule]", 
      RowBox[{"R", " ", 
       RowBox[{"ground", "[", "3", "]"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"AddBody", "[", 
     RowBox[{
     "stanceContactPoint", ",", " ", "stanceFoot", ",", " ", "Fixed", ",", 
      RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
      RowBox[{"BodyToJnt", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "R"}], "}"}]}]}], "]"}], ";"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swingLegMassOffsetVector", " ", "=", " ", 
   RowBox[{
    RowBox[{"legMassVerticalOffset", " ", 
     RowBox[{"swingLeg", "[", "3", "]"}]}], "-", 
    RowBox[{"legMassForwardOffset", " ", 
     RowBox[{"swingLeg", "[", "1", "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"swingLegJoint", ",", " ", "pelvis", ",", " ", "Hinge", ",", " ", 
    RowBox[{"Axis", "->", 
     RowBox[{"ground", "[", "2", "]"}]}], ",", 
    RowBox[{"RelativeTo", "\[Rule]", "ground"}], ",", " ", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"pelvisWidth", "/", "2"}], ")"}]}], " ", 
      RowBox[{"pelvis", "[", "2", "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"swingLeg", ",", " ", "swingLegJoint", ",", " ", "Fixed", ",", 
    RowBox[{"Offset", " ", "\[Rule]", " ", "swingLegSplayRotation"}], ",", 
    RowBox[{"Mass", "\[Rule]", "MLeg"}], ",", 
    RowBox[{"Inertia", "->", 
     RowBox[{"{", 
      RowBox[{"ILeg", ",", "ILeg", ",", " ", "0"}], "}"}]}], ",", 
    RowBox[{"InbToJnt", "->", "0"}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "swingLegMassOffsetVector"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AddBody", "[", 
   RowBox[{"swingFoot", ",", " ", "swingLeg", ",", " ", "Fixed", ",", 
    RowBox[{"InbToJnt", "\[Rule]", 
     RowBox[{"swingLegMassOffsetVector", " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"L", " ", "-", "R"}], ")"}], " ", 
       RowBox[{"swingLeg", "[", "3", "]"}]}]}]}], ",", 
    RowBox[{"BodyToJnt", "\[Rule]", "0"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AddBody", "[", 
    RowBox[{
    "swingContactPoint", ",", " ", "swingFoot", ",", " ", "Fixed", ",", 
     RowBox[{"InbToJnt", "\[Rule]", "0"}], ",", 
     RowBox[{"BodyToJnt", "\[Rule]", " ", 
      RowBox[{"R", " ", 
       RowBox[{"ground", "[", "3", "]"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"might", " ", "be", " ", "an", " ", "optimization"}], ",", " ", 
    RowBox[{"might", " ", "not"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"VelCOM", "[", "stanceLegJoint", "]"}], "=", 
      RowBox[{"CastV", "[", 
       RowBox[{
        RowBox[{"VelCOM", "[", "stanceLegJoint", "]"}], ",", 
        "stanceLegJoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AccCOM", "[", "stanceLegJoint", "]"}], "=", 
      RowBox[{"CastV", "[", 
       RowBox[{
        RowBox[{"AccCOM", "[", "stanceLegJoint", "]"}], ",", 
        "stanceLegJoint"}], "]"}]}], ";"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446933798487845*^9, 3.4469338643521357`*^9}, {
   3.446933973115541*^9, 3.446933973964518*^9}, {3.446934165197138*^9, 
   3.446934196255003*^9}, {3.446934232495329*^9, 3.446934296806625*^9}, {
   3.4469343369097557`*^9, 3.446934396401021*^9}, {3.446934874977736*^9, 
   3.446934894293985*^9}, {3.44693499207298*^9, 3.446935146273335*^9}, {
   3.44693525471518*^9, 3.446935466215646*^9}, {3.446935962145954*^9, 
   3.446935976732356*^9}, {3.446936070668562*^9, 3.44693608258097*^9}, {
   3.4469363147903633`*^9, 3.446936338677568*^9}, 3.446936378812018*^9, {
   3.4471087351120424`*^9, 3.4471087378627677`*^9}, {3.4481026874620094`*^9, 
   3.448102702886552*^9}, {3.448102761625425*^9, 3.448102768122074*^9}, {
   3.448102820844346*^9, 3.4481028223004913`*^9}, {3.4821414061689053`*^9, 
   3.4821414214108224`*^9}, {3.4821414642524257`*^9, 3.482141476149533*^9}, {
   3.482141655136904*^9, 3.482141660013917*^9}, {3.482141725858597*^9, 
   3.4821417277513185`*^9}, {3.5787505024899487`*^9, 
   3.5787505075804577`*^9}, {3.578750795509248*^9, 3.578750833278024*^9}, {
   3.5787515081510377`*^9, 3.5787515744540377`*^9}, {3.5787516523330374`*^9, 
   3.5787516576120377`*^9}, 3.578751755209038*^9, {3.5787519016520376`*^9, 
   3.5787519046600375`*^9}, 3.578751984209038*^9, {3.5787520234300375`*^9, 
   3.5787520336910377`*^9}, {3.5787520869020376`*^9, 
   3.5787521186160374`*^9}, {3.5787521561120377`*^9, 
   3.5787521592220373`*^9}, {3.578752219320038*^9, 3.5787522391240377`*^9}, {
   3.578752342478038*^9, 3.5787523564200373`*^9}, {3.5787524939440374`*^9, 
   3.5787525420950375`*^9}, {3.5787526077960377`*^9, 
   3.5787526490530376`*^9}, {3.5787527942390375`*^9, 3.578752880006308*^9}, 
   3.578753553127974*^9, {3.578753590520713*^9, 3.578753590831744*^9}, {
   3.5787536331139717`*^9, 3.5787536912077804`*^9}, {3.578753746087268*^9, 
   3.5787537494146004`*^9}, {3.5787538261142697`*^9, 
   3.5787538356952276`*^9}, {3.5787539018298407`*^9, 
   3.5787539197406316`*^9}, {3.5787569081818776`*^9, 3.578756939778037*^9}, {
   3.5787569830193605`*^9, 3.5787570021842766`*^9}, {3.578757048379896*^9, 
   3.5787570921412716`*^9}, {3.5787571423192887`*^9, 
   3.5787572521772738`*^9}, {3.5787574736334233`*^9, 
   3.5787574787504234`*^9}, {3.5787595447984233`*^9, 
   3.5787596145914235`*^9}, {3.578761451693204*^9, 3.57876145545858*^9}, {
   3.578761545697603*^9, 3.578761547255759*^9}, {3.578761591118145*^9, 
   3.578761686961728*^9}, {3.578761830974128*^9, 3.5787618317922096`*^9}, {
   3.5787618807371035`*^9, 3.5787618823662663`*^9}, {3.5787619276167912`*^9, 
   3.5787619907801065`*^9}, {3.578762042038232*^9, 3.578762101291157*^9}, 
   3.5787624416331873`*^9, {3.578769908001306*^9, 3.5787699081383133`*^9}, {
   3.5788397042839365`*^9, 3.5788397058029366`*^9}, {3.5788397440249367`*^9, 
   3.578839746792937*^9}, 3.578850230916913*^9, 3.5788537759170055`*^9, {
   3.5788538806049933`*^9, 3.578853882016074*^9}, {3.578855936226568*^9, 
   3.578855937185623*^9}, 3.578856847970717*^9, {3.57920068050898*^9, 
   3.579200786570789*^9}, {3.579200878075232*^9, 3.579200900422593*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply gravitational and spring forces", "Subsubsection",
 CellChangeTimes->{{3.446936462821484*^9, 3.446936493067205*^9}, {
  3.4482332964944153`*^9, 3.448233342564022*^9}, {3.483287161868603*^9, 
  3.483287162519539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"pelvis", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "pelvis", "]"}], " ", "grav"}], ",", " ", "0"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppFrc", "[", 
   RowBox[{"stanceLeg", ",", 
    RowBox[{
     RowBox[{"Mass", "[", "stanceLeg", "]"}], " ", "grav"}], ",", "0"}], 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppFrc", "[", 
    RowBox[{"swingLeg", ",", 
     RowBox[{
      RowBox[{"Mass", "[", "swingLeg", "]"}], " ", "grav"}], ",", "0"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "spring", " ", "between", " ", "legs", "\[IndentingNewLine]", 
      "hipSpringExtension"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"q", "[", "5", "]"}], "-", 
      RowBox[{"q", "[", "6", "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppTrq", "[", 
     RowBox[{"stanceLeg", ",", " ", 
      RowBox[{
       RowBox[{"-", "KHip"}], " ", "*", " ", "hipSpringExtension", " ", "*", 
       RowBox[{"stanceLeg", "[", "2", "]"}]}]}], "]"}], ";", "\n", 
    RowBox[{"AppTrq", "[", 
     RowBox[{"swingLeg", ",", " ", 
      RowBox[{"KHip", " ", "*", " ", "hipSpringExtension", "*", " ", 
       RowBox[{"swingLeg", "[", "2", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"legAngleDisplacement", " ", "=", " ", 
  RowBox[{
   RowBox[{"q", "[", "6", "]"}], " ", "-", " ", 
   RowBox[{"q", "[", "5", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppTrq", "[", 
   RowBox[{"stanceLeg", ",", " ", 
    RowBox[{"KSwing", " ", "*", " ", "legAngleDisplacement", " ", "*", 
     RowBox[{"stanceLeg", "[", "2", "]"}]}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppTrq", "[", 
    RowBox[{"swingLeg", ",", " ", 
     RowBox[{
      RowBox[{"-", "KSwing"}], " ", "*", " ", "legAngleDisplacement", "*", 
      " ", 
      RowBox[{"swingLeg", "[", "2", "]"}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppTrq", "[", 
     RowBox[{"stanceLeg", ",", " ", 
      RowBox[{"KSwing", " ", "*", " ", 
       RowBox[{"q", "[", "6", "]"}], " ", "*", 
       RowBox[{"stanceLeg", "[", "2", "]"}]}]}], "]"}], ";", "\n", 
    RowBox[{"AppTrq", "[", 
     RowBox[{"swingLeg", ",", " ", 
      RowBox[{
       RowBox[{"-", "KSwing"}], " ", "*", " ", 
       RowBox[{"q", "[", "6", "]"}], "*", " ", 
       RowBox[{"swingLeg", "[", "2", "]"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppFrc", "[", 
    RowBox[{"pelvis", ",", " ", 
     RowBox[{"lateralPelvisForce", " ", 
      RowBox[{"ground", "[", "2", "]"}]}], ",", " ", "0"}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"directionOfGravity", " ", "=", "  ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "groundAngle", "]"}]}], " ", 
      RowBox[{"ground", "[", "3", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Sin", "[", "groundAngle", "]"}], " ", 
      RowBox[{"ground", "[", "1", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grav", "=", 
   RowBox[{"g", " ", "*", " ", "directionOfGravity"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.446933798487845*^9, 3.4469338643521357`*^9}, {
   3.446933973115541*^9, 3.446933973964518*^9}, {3.446934165197138*^9, 
   3.446934196255003*^9}, {3.446934232495329*^9, 3.446934296806625*^9}, {
   3.4469343369097557`*^9, 3.446934396401021*^9}, {3.446934874977736*^9, 
   3.446934894293985*^9}, {3.44693499207298*^9, 3.446935146273335*^9}, {
   3.44693525471518*^9, 3.446935466215646*^9}, {3.446935962145954*^9, 
   3.446935976732356*^9}, {3.446936070668562*^9, 3.44693608258097*^9}, {
   3.4469363147903633`*^9, 3.446936338677568*^9}, 3.446936378812018*^9, 
   3.4469364610240583`*^9, {3.4475855130356894`*^9, 3.4475855219784155`*^9}, {
   3.447978308088942*^9, 3.4479783106736836`*^9}, {3.4479783870460453`*^9, 
   3.447978484110526*^9}, {3.4479841407195263`*^9, 3.4479841960575266`*^9}, 
   3.4479844393925266`*^9, {3.4479845083805265`*^9, 3.447984518412526*^9}, {
   3.4479846555075264`*^9, 3.4479846601115265`*^9}, {3.4479847738695264`*^9, 
   3.4479847813245263`*^9}, {3.4479848288575263`*^9, 
   3.4479849433645267`*^9}, {3.4480987792682242`*^9, 
   3.4480987798112783`*^9}, {3.4481029399452553`*^9, 3.448103051450404*^9}, {
   3.4481030917564344`*^9, 3.448103107434002*^9}, {3.448103148577116*^9, 
   3.4481032313756886`*^9}, {3.4481054441571136`*^9, 
   3.4481054648399763`*^9}, {3.4483301941466227`*^9, 
   3.4483302194216223`*^9}, {3.482142877494568*^9, 3.4821428791169004`*^9}, {
   3.4821429310916367`*^9, 3.482142940364971*^9}, {3.4821429710891504`*^9, 
   3.482142978960469*^9}, {3.4821430412700653`*^9, 3.4821433715850353`*^9}, {
   3.482143422768634*^9, 3.482143462205341*^9}, 3.4821439194528303`*^9, {
   3.482143970386069*^9, 3.4821440096825743`*^9}, {3.482171949209017*^9, 
   3.482172118117906*^9}, {3.4821721968117747`*^9, 3.4821722426633596`*^9}, 
   3.4821923440432043`*^9, {3.4825769635486126`*^9, 3.4825769667866125`*^9}, {
   3.4825770019776125`*^9, 3.4825770097766128`*^9}, {3.4825770516456127`*^9, 
   3.482577108920613*^9}, {3.4825772275936127`*^9, 3.482577233514613*^9}, {
   3.4825773184166126`*^9, 3.482577323414613*^9}, {3.48320629996772*^9, 
   3.483206357751589*^9}, {3.4832063992646575`*^9, 3.483206399785323*^9}, {
   3.483206449620011*^9, 3.483206486248662*^9}, {3.483207111809553*^9, 
   3.483207129773413*^9}, {3.483207236835617*^9, 3.4832072404303913`*^9}, {
   3.4832073996218348`*^9, 3.4832074012540026`*^9}, {3.483207499225484*^9, 
   3.483207514075652*^9}, {3.4832084365785522`*^9, 3.4832084740794845`*^9}, {
   3.48320850893744*^9, 3.483208521524786*^9}, {3.4832086286424046`*^9, 
   3.4832087388743153`*^9}, {3.4832089448481674`*^9, 3.483209041210965*^9}, {
   3.4832096651840973`*^9, 3.483209666005245*^9}, 3.483211368283484*^9, {
   3.4832114596421185`*^9, 3.4832115327650766`*^9}, {3.4832116128083754`*^9, 
   3.483211730084671*^9}, {3.4832118060023212`*^9, 3.483211828814669*^9}, {
   3.48321219187949*^9, 3.4832122032155647`*^9}, {3.4832134191597567`*^9, 
   3.483213449753138*^9}, 3.4832135577362566`*^9, 3.4832143171401987`*^9, {
   3.4832191647171187`*^9, 3.4832192205373845`*^9}, 3.4832192765779667`*^9, {
   3.483219320400981*^9, 3.483219358035096*^9}, {3.4832194039210773`*^9, 
   3.483219445520895*^9}, {3.483221374644839*^9, 3.4832213767979345`*^9}, {
   3.483221409745311*^9, 3.483221458164935*^9}, {3.4832216071191206`*^9, 
   3.483221619837408*^9}, {3.483229760086443*^9, 3.4832297843012624`*^9}, {
   3.4832871514736557`*^9, 3.483287152184678*^9}, {3.4832918597838736`*^9, 
   3.4832918985896735`*^9}, {3.4832925936891775`*^9, 
   3.4832926077293663`*^9}, {3.4832927055800686`*^9, 
   3.4832927084041295`*^9}, {3.4832934279788275`*^9, 3.48329342834936*^9}, {
   3.4832934815458527`*^9, 3.483293485852045*^9}, {3.4832937304737935`*^9, 
   3.483293747087683*^9}, {3.4832939173625264`*^9, 3.4832939234713106`*^9}, {
   3.483294190224883*^9, 3.4832942129976287`*^9}, {3.483294657066168*^9, 
   3.4832946600104017`*^9}, {3.4832953921932287`*^9, 
   3.4832953939858065`*^9}, {3.4832956300452433`*^9, 3.483295634411522*^9}, {
   3.483295719744224*^9, 3.483295721416629*^9}, {3.4832959130822306`*^9, 
   3.483295913623008*^9}, 3.4832959536705933`*^9, {3.483295988921282*^9, 
   3.4832959894720736`*^9}, {3.4832961923137455`*^9, 3.483296202418275*^9}, {
   3.483296447370499*^9, 3.483296449563653*^9}, {3.483297269903243*^9, 
   3.4832972747101555`*^9}, {3.483297319664797*^9, 3.4832973276262445`*^9}, {
   3.4832980016354227`*^9, 3.4832980073736734`*^9}, {3.48329807327844*^9, 
   3.483298082591832*^9}, {3.483298190256646*^9, 3.483298192299584*^9}, {
   3.4832988038689775`*^9, 3.4832988092266817`*^9}, {3.4832988650469475`*^9, 
   3.4832988712759037`*^9}, {3.483299623587675*^9, 3.483299626181405*^9}, {
   3.484471801761492*^9, 3.4844718036876016`*^9}, {3.484472037269962*^9, 
   3.484472067850711*^9}, {3.4844723938483567`*^9, 3.4844724241760917`*^9}, {
   3.4844726609746356`*^9, 3.4844726772145643`*^9}, {3.4901089517952385`*^9, 
   3.490109003245239*^9}, {3.4902305688547387`*^9, 3.4902306225901117`*^9}, {
   3.490291128458542*^9, 3.490291207641346*^9}, {3.4902912392774196`*^9, 
   3.4902912396118536`*^9}, {3.4902912896327963`*^9, 
   3.4902913547900257`*^9}, {3.4902916844462748`*^9, 3.490291685253436*^9}, {
   3.4903001528455243`*^9, 3.4903002651157503`*^9}, {3.490304894344627*^9, 
   3.490304901214314*^9}, 3.4912316351961613`*^9, {3.4912333794642963`*^9, 
   3.4912334598999567`*^9}, {3.491303206775587*^9, 3.491303215608288*^9}, {
   3.4913032986476927`*^9, 3.491303298978168*^9}, {3.4913036280713806`*^9, 
   3.4913036762606735`*^9}, {3.491305954967293*^9, 3.491305967104746*^9}, {
   3.4913060295345154`*^9, 3.4913061332937136`*^9}, 3.4913154497080913`*^9, {
   3.5787539599826555`*^9, 3.5787539973963966`*^9}, {3.578754048571513*^9, 
   3.578754104725128*^9}, {3.578754135266182*^9, 3.578754135660221*^9}, {
   3.578754177282383*^9, 3.578754179705428*^9}, {3.5787542953344283`*^9, 
   3.578754358396428*^9}, 3.5787543977554283`*^9, {3.5787545501624284`*^9, 
   3.5787545851674285`*^9}, {3.5787546195154285`*^9, 3.5787546623594284`*^9}, 
   {3.5787546950234284`*^9, 3.5787547465304284`*^9}, {3.5787549427934284`*^9, 
   3.5787549513504286`*^9}, {3.578754983113428*^9, 3.5787549957474284`*^9}, {
   3.5787550385964284`*^9, 3.5787550805504284`*^9}, 3.578759739886423*^9, {
   3.5787618056245933`*^9, 3.5787618093969707`*^9}, {3.5787621061486425`*^9, 
   3.578762107741802*^9}, {3.578768807953387*^9, 3.578768809973502*^9}, {
   3.5787690177673874`*^9, 3.578769040924712*^9}, {3.5787699111284847`*^9, 
   3.5787699230311656`*^9}, 3.578769959740265*^9, {3.5791017428388863`*^9, 
   3.579101775804681*^9}, {3.5791024148098526`*^9, 3.5791024619635677`*^9}, {
   3.57910477732629*^9, 3.57910479179729*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AppendTo", "::", "rvalue"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(Force[stanceLeg]\\)\[NoBreak] is not a \
variable with a value, so its value cannot be changed. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/rvalue\\\", \
ButtonNote -> \\\"AppendTo::rvalue\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006963077183`*^9, 3.5792007262516985`*^9}, {
  3.5792007726186047`*^9, 3.5792007969889135`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AppendTo", "::", "rvalue"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(Force[swingLeg]\\)\[NoBreak] is not a \
variable with a value, so its value cannot be changed. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/rvalue\\\", \
ButtonNote -> \\\"AppendTo::rvalue\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006963077183`*^9, 3.5792007262516985`*^9}, {
  3.5792007726186047`*^9, 3.5792007970809407`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["q", "5"]}], "+", 
  SubscriptBox["q", "6"]}]], "Output",
 CellChangeTimes->{
  3.579101915265376*^9, 3.579102475446916*^9, 3.57910449756329*^9, {
   3.5791047813432903`*^9, 3.57910480172129*^9}, 3.5792005467141027`*^9, {
   3.5792006964037466`*^9, 3.5792007262827077`*^9}, {3.579200772709632*^9, 
   3.579200797106949*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AppendTo", "::", "rvalue"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(Torque[stanceLeg]\\)\[NoBreak] is not a \
variable with a value, so its value cannot be changed. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/rvalue\\\", \
ButtonNote -> \\\"AppendTo::rvalue\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006963077183`*^9, 3.5792007262516985`*^9}, {
  3.5792007726186047`*^9, 3.5792007971789703`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AppendTo", "::", "rvalue"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(Torque[swingLeg]\\)\[NoBreak] is not a \
variable with a value, so its value cannot be changed. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/rvalue\\\", \
ButtonNote -> \\\"AppendTo::rvalue\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006963077183`*^9, 3.5792007262516985`*^9}, {
  3.5792007726186047`*^9, 3.5792007972729983`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate equations of motion, energies\
\>", "Subsubsection",
 CellChangeTimes->{{3.446936462821484*^9, 3.446936493067205*^9}, {
   3.4482332964944153`*^9, 3.448233342564022*^9}, {3.483287161868603*^9, 
   3.483287162519539*^9}, {3.5787553012144284`*^9, 3.5787553081574287`*^9}, 
   3.5787553808734283`*^9, {3.5787597465054235`*^9, 3.578759748089423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eom", " ", "=", " ", 
   RowBox[{"EOM", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MM", ",", "rhs"}], "}"}], "=", 
    RowBox[{
     RowBox[{"MassMatrix", "[", "eom", "]"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "MM", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalMass", " ", "=", " ", 
    RowBox[{
     RowBox[{"Mass", "[", "pelvis", "]"}], " ", "+", " ", 
     RowBox[{"Mass", "[", "stanceLeg", "]"}], "+", " ", 
     RowBox[{"Mass", "[", "swingLeg", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalCOMPositionTimesMass", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Mass", "[", "pelvis", "]"}], 
       RowBox[{"PosCOM", "[", "pelvis", "]"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mass", "[", "stanceLeg", "]"}], 
       RowBox[{"PosCOM", "[", "stanceLeg", "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"Mass", "[", "swingLeg", "]"}], 
       RowBox[{"PosCOM", "[", "swingLeg", "]"}]}]}], " ", "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PEGravity", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"totalCOMPositionTimesMass", ".", "grav"}]}], "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PESpring", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "KSwing", " ", 
       RowBox[{"q", "[", "6", "]"}], 
       RowBox[{"q", "[", "6", "]"}]}], "//", "Simplify"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PESpring", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "KSwing", " ", "legAngleDisplacement", 
      " ", "*", " ", "legAngleDisplacement"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PE", " ", "=", " ", 
    RowBox[{
     RowBox[{"PEGravity", "+", "PESpring"}], "//", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"comVelocity", " ", "=", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Mass", "[", "pelvis", "]"}], "*", 
         RowBox[{"VelCOM", "[", "pelvis", "]"}]}], " ", "+", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mass", "[", "stanceLeg", "]"}], "*", 
         RowBox[{"VelCOM", "[", "stanceLeg", "]"}]}], " ", "+", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Mass", "[", "swingLeg", "]"}], "*", 
         RowBox[{"VelCOM", "[", "swingLeg", "]"}]}]}], ")"}], " ", "/", " ", 
      "totalMass"}], " ", "//", " ", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KELinear", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Mass", "[", "pelvis", "]"}], "*", 
        RowBox[{
         RowBox[{"VelCOM", "[", "pelvis", "]"}], ".", 
         RowBox[{"VelCOM", "[", "pelvis", "]"}]}]}], " ", "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mass", "[", "stanceLeg", "]"}], "*", 
        RowBox[{
         RowBox[{"VelCOM", "[", "stanceLeg", "]"}], ".", 
         RowBox[{"VelCOM", "[", "stanceLeg", "]"}]}]}], "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mass", "[", "swingLeg", "]"}], "*", 
        RowBox[{
         RowBox[{"VelCOM", "[", "swingLeg", "]"}], ".", 
         RowBox[{"VelCOM", "[", "swingLeg", "]"}]}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KELinear", " ", "=", " ", 
     RowBox[{"FullSimplify", "[", "KELinear", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "wrong"}], ",", " ", 
    RowBox[{
    "it", " ", "only", " ", "takes", " ", "into", " ", "energy", " ", "of", 
     " ", "the", " ", "com"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "not", " ", "about", " ", "the", " ", "com", "\[IndentingNewLine]", 
       "KELinear"}], " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], " ", "*", " ", "totalMass", " ", "*",
         " ", 
        RowBox[{"comVelocity", ".", "comVelocity"}]}], " ", "//", " ", 
       "Simplify"}]}], ";"}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KERotational", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Inertia", "[", "pelvis", "]"}], ".", 
         RowBox[{"AngVel", "[", "pelvis", "]"}], ".", 
         RowBox[{"AngVel", "[", "pelvis", "]"}]}], " ", "+", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Inertia", "[", "stanceLeg", "]"}], ".", 
         RowBox[{"AngVel", "[", "stanceLeg", "]"}], ".", 
         RowBox[{"AngVel", "[", "stanceLeg", "]"}]}], " ", "+", " ", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Inertia", "[", "swingLeg", "]"}], ".", 
         RowBox[{"AngVel", "[", "swingLeg", "]"}], ".", 
         RowBox[{"AngVel", "[", "swingLeg", "]"}]}]}], ")"}]}], " ", "//", 
     " ", "Simplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KE", " ", "=", " ", 
    RowBox[{"KELinear", " ", "+", " ", "KERotational"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"KE", " ", "=", " ", "KERotational"}], ";", "\[IndentingNewLine]", 
    RowBox[{"KE", " ", "=", " ", "KELinear"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"centerOfMassPosition", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Mass", "[", "pelvis", "]"}], "*", 
        RowBox[{"PosCOM", "[", "pelvis", "]"}]}], " ", "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mass", "[", "stanceLeg", "]"}], "*", 
        RowBox[{"PosCOM", "[", "stanceLeg", "]"}]}], " ", "+", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Mass", "[", "swingLeg", "]"}], "*", 
        RowBox[{"PosCOM", "[", "swingLeg", "]"}]}]}], ")"}], " ", "/", " ", 
     "totalMass"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"totalForceOnCOM", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Mass", "[", "pelvis", "]"}], "*", 
      RowBox[{"AccCOM", "[", "pelvis", "]"}]}], " ", "+", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Mass", "[", "stanceLeg", "]"}], "*", 
      RowBox[{"AccCOM", "[", "stanceLeg", "]"}]}], " ", "+", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Mass", "[", "swingLeg", "]"}], "*", 
      RowBox[{"AccCOM", "[", "swingLeg", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalTorqueAroundCOM", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Inertia", "[", "pelvis", "]"}], ".", 
      RowBox[{"AngAcc", "[", "pelvis", "]"}]}], " ", "+", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Inertia", "[", "stanceLeg", "]"}], ".", 
      RowBox[{"AngAcc", "[", "stanceLeg", "]"}]}], "+", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Inertia", "[", "swingLeg", "]"}], ".", 
      RowBox[{"AngAcc", "[", "swingLeg", "]"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446934958453143*^9, 3.4469349610737743`*^9}, {
   3.446935214939715*^9, 3.446935217192977*^9}, {3.4479841720295267`*^9, 
   3.447984174313526*^9}, {3.448097617390153*^9, 3.4480976660111527`*^9}, 
   3.4480990324075356`*^9, {3.4480990838986845`*^9, 3.4480990893202267`*^9}, 
   3.4821410703760595`*^9, {3.4902913471702175`*^9, 3.490291361226242*^9}, 
   3.490291394306774*^9, {3.4902916933210497`*^9, 3.490291716651715*^9}, {
   3.4902918000413895`*^9, 3.4902918026969204`*^9}, {3.4902956443947244`*^9, 
   3.490295651859471*^9}, {3.49029568645193*^9, 3.4902956952788124`*^9}, {
   3.490296043368618*^9, 3.4902960720574865`*^9}, {3.490296136357916*^9, 
   3.49029619200848*^9}, 3.490296227721051*^9, {3.4903044502652235`*^9, 
   3.490304457512948*^9}, {3.4912330241433697`*^9, 3.4912330244337873`*^9}, 
   3.4913154550057087`*^9, {3.5787553344854283`*^9, 3.5787553672654285`*^9}, {
   3.578759743247423*^9, 3.578759743728423*^9}, {3.578761398313866*^9, 
   3.578761403705405*^9}, {3.5787626893559575`*^9, 3.57876269818484*^9}, 
   3.5787628724162617`*^9, {3.57876304231625*^9, 3.578763076149633*^9}, 
   3.5787631622262397`*^9, 3.5787660950097313`*^9, 3.578768880586541*^9, 
   3.5787690062147264`*^9, 3.5787690575076604`*^9, 3.578769237354947*^9, {
   3.5787699477115774`*^9, 3.578769951151774*^9}, 3.5787709123040323`*^9, {
   3.5787761300831623`*^9, 3.5787761334581623`*^9}, {3.5787762304591618`*^9, 
   3.578776242861162*^9}, {3.578776454001162*^9, 3.5787764543001623`*^9}, {
   3.578776631878162*^9, 3.578776638325162*^9}, {3.5787766884801617`*^9, 
   3.5787767062151623`*^9}, 3.5787767621161623`*^9, 3.578776880931162*^9, {
   3.578776927595162*^9, 3.578776930582162*^9}, {3.578776971021162*^9, 
   3.578776978163162*^9}, 3.5787770259391623`*^9, {3.578777096757162*^9, 
   3.578777103809162*^9}, {3.578849145195913*^9, 3.578849149640913*^9}, {
   3.5788491875399127`*^9, 3.578849198579913*^9}, {3.5788492754079127`*^9, 
   3.5788493095169125`*^9}, {3.578849385834913*^9, 3.5788494022009125`*^9}, {
   3.578849501333913*^9, 3.578849545260913*^9}, {3.5788545546775484`*^9, 
   3.578854564783126*^9}, {3.578854630006857*^9, 3.5788546321169777`*^9}, {
   3.578855385895091*^9, 3.5788554326647663`*^9}, {3.578855503079794*^9, 
   3.5788555041348543`*^9}, {3.5788557247734737`*^9, 3.578855762388625*^9}, {
   3.5788558520967565`*^9, 3.5788558923260574`*^9}, {3.5790210873057876`*^9, 
   3.5790210884669037`*^9}, {3.5791018623119125`*^9, 3.579101880159832*^9}, {
   3.5792005334858494`*^9, 3.579200537236473*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"MPelvis", "0", "0", "0", "0"},
     {"0", "MPelvis", "0", "0", "0"},
     {"0", "0", "MPelvis", "0", "0"},
     {"0", "0", "0", "IPelvis", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5792005523220253`*^9, {3.5792006966058073`*^9, 3.579200726412747*^9}, {
   3.57920077290569*^9, 3.5792007973740287`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Kinematic Points", "Section",
 CellChangeTimes->{{3.446936522284877*^9, 3.446936526233658*^9}, {
  3.482180100156204*^9, 3.4821801031942043`*^9}}],

Cell["These points will be used for plotting the robot in matlab", "Text",
 CellChangeTimes->{{3.4469366383944397`*^9, 3.446936650030229*^9}, {
   3.4821442962045727`*^9, 3.482144427222968*^9}, {3.4821444934081373`*^9, 
   3.482144572612027*^9}, {3.482144603216034*^9, 3.4821447118923025`*^9}, {
   3.4821458209270163`*^9, 3.482145874433955*^9}, {3.482180118674204*^9, 
   3.4821801373532043`*^9}, 3.5787552597654285`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pelvisPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "pelvis", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"pelvis", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pelvisR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stanceLegPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "stanceLeg", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"stanceLeg", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stanceLegR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"swingLegPosition", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "swingLeg", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thisFrame", " ", "=", " ", 
   RowBox[{"CastMtx", "[", 
    RowBox[{"swingLeg", ",", " ", "ground"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swingLegR", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", " ", 
        RowBox[{"thisFrame", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stanceFootCenter", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "stanceFoot", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swingFootCenter", " ", "=", " ", 
    RowBox[{"PosCOM", "[", "swingFoot", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stanceFootContactPoint", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "stanceContactPoint", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swingFootContactPoint", " ", "=", " ", 
    RowBox[{"PosCOM", "[", "swingContactPoint", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"stanceHipPoint", " ", "=", " ", 
   RowBox[{"PosCOM", "[", "stanceLegJoint", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"swingHipPoint", " ", "=", " ", 
    RowBox[{"PosCOM", "[", "swingLegJoint", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.446935543679307*^9, 3.446935599122636*^9}, {
   3.446935808059744*^9, 3.446935857823979*^9}, {3.446935929982038*^9, 
   3.446935951548718*^9}, {3.4469361242103558`*^9, 3.4469361388641233`*^9}, {
   3.4471108208344097`*^9, 3.44711084481641*^9}, 3.44711090527741*^9, {
   3.482142931321968*^9, 3.482142931321968*^9}, {3.4821447524906797`*^9, 
   3.482144771528054*^9}, {3.4821452640362463`*^9, 3.482145342809517*^9}, {
   3.482180166634204*^9, 3.482180241325204*^9}, {3.4821804823242044`*^9, 
   3.482180522189204*^9}, {3.4821805535632043`*^9, 3.482180669773204*^9}, {
   3.482181021981204*^9, 3.482181089575204*^9}, {3.4821812127322044`*^9, 
   3.482181225667204*^9}, {3.482181265289204*^9, 3.482181369539204*^9}, {
   3.4821818544702044`*^9, 3.482181870433204*^9}, {3.4821819669452043`*^9, 
   3.482182080349204*^9}, {3.4821821181352043`*^9, 3.4821821955762043`*^9}, {
   3.482182236735204*^9, 3.482182308554204*^9}, {3.4821837717652044`*^9, 
   3.482183804309204*^9}, {3.4821838841922045`*^9, 3.4821838896952043`*^9}, {
   3.482183955052204*^9, 3.482184017236204*^9}, {3.4821840489872046`*^9, 
   3.4821840714092045`*^9}, {3.4821846973782043`*^9, 
   3.4821846977912045`*^9}, {3.482187446781204*^9, 3.482187462605204*^9}, {
   3.482187504132204*^9, 3.4821875923782043`*^9}, {3.4821880850812044`*^9, 
   3.482188166834204*^9}, {3.4821882190412045`*^9, 3.4821882199492044`*^9}, 
   3.4821882775602045`*^9, {3.4821884972062044`*^9, 3.482188514183204*^9}, {
   3.4821905998062043`*^9, 3.482190617679204*^9}, {3.482190789973204*^9, 
   3.4821908211612043`*^9}, {3.4823344128998117`*^9, 
   3.4823344531318116`*^9}, {3.4824328743230295`*^9, 3.482432879268029*^9}, {
   3.482443227091878*^9, 3.482443230695238*^9}, {3.4832152405788307`*^9, 
   3.4832152450552225`*^9}, {3.578755431429428*^9, 3.5787554404574285`*^9}, {
   3.5787554860974283`*^9, 3.5787554916364284`*^9}, {3.5787563081354284`*^9, 
   3.5787563569994287`*^9}, {3.578756660995161*^9, 3.57875674958702*^9}, {
   3.5787574844024234`*^9, 3.578757498733423*^9}, {3.5787576269964237`*^9, 
   3.5787576286604233`*^9}, {3.578757901334423*^9, 3.5787579916244235`*^9}, {
   3.5787596272274237`*^9, 3.5787596465214233`*^9}, {3.57876353976799*^9, 
   3.5787635523512487`*^9}, 3.578763660234418*^9, {3.578839538771937*^9, 
   3.578839539678937*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(Tmtx[\\(\\(Uncommon1[\\(\\(\\(\\(Parents[stanceLeg]\\)\\), \
\\(\\({}\\)\\)\\)\\)]\\)\\)]\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.579200797552082*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(3\\)\[NoBreak] of \
\[NoBreak]\\!\\(Tmtx[\\(\\(Uncommon1[\\(\\(\\(\\(Parents[stanceLeg]\\)\\), \
\\(\\({}\\)\\)\\)\\)]\\)\\)]\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.579200797637108*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(Transpose[\\(\\(Tmtx[\\(\\(Uncommon2[\\(\\(\\(\\(Parents[\
stanceLeg]\\)\\), \\(\\({}\\)\\)\\)\\)]\\)\\)]\\)\\)]\\)\[NoBreak] does not \
exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.5792007977241335`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partw\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.57920079777815*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(Tmtx[\\(\\(Uncommon1[\\(\\(\\(\\(Parents[swingLeg]\\)\\), \\(\
\\({}\\)\\)\\)\\)]\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.579200797868177*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(3\\)\[NoBreak] of \
\[NoBreak]\\!\\(Tmtx[\\(\\(Uncommon1[\\(\\(\\(\\(Parents[swingLeg]\\)\\), \\(\
\\({}\\)\\)\\)\\)]\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.579200797951202*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(Transpose[\\(\\(Tmtx[\\(\\(Uncommon2[\\(\\(\\(\\(Parents[\
swingLeg]\\)\\), \\(\\({}\\)\\)\\)\\)]\\)\\)]\\)\\)]\\)\[NoBreak] does not \
exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.5792007980372276`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partw\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006967308445`*^9, 3.5792007266008034`*^9}, {
  3.5792007730427313`*^9, 3.579200798087243*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Constraint equations", "Section",
 CellChangeTimes->{{3.446936522284877*^9, 3.446936526233658*^9}}],

Cell[TextData[{
 "There are several states that this machine can be in. Minimally, we just \
have single support and flight, and to handle left stance vs right stance, we \
could switch the states right before the heelstrike. If we just drew this, \
though, it would look strange (it would keep starting on the left foot). \
Maybe we can always just simulate one step, then when we\[CloseCurlyQuote]re \
plotting we can choose to flip the states to make them look like the old \
swing foot is the new stance foot. Let\[CloseCurlyQuote]s have 3 nominal \
states.\n\n",
 StyleBox["flight",
  FontWeight->"Bold"],
 " shouldn\[CloseCurlyQuote]t ever happen\n",
 StyleBox["stanceFootRolling",
  FontWeight->"Bold"],
 ", all time spent here\n",
 StyleBox["swing foot rolling",
  FontWeight->"Bold"],
 ", only used to calculate the results of heelstrike at the instant before we \
switch feet\n\nWe could have also implemented this using only stance foot \
rolling and flight, where you switch the states, and then perform impact, but \
that might not have fit as well with the hybrid dynamic system framework we \
have set up."
}], "Text",
 CellChangeTimes->{{3.4469366383944397`*^9, 3.446936650030229*^9}, {
   3.4821442962045727`*^9, 3.482144427222968*^9}, {3.4821444934081373`*^9, 
   3.482144572612027*^9}, {3.482144603216034*^9, 3.4821447118923025`*^9}, {
   3.4821458209270163`*^9, 3.482145874433955*^9}, {3.5787580391964235`*^9, 
   3.5787580427954235`*^9}, {3.5787581602604237`*^9, 
   3.5787582881734233`*^9}, {3.5787583702004232`*^9, 
   3.5787583729364233`*^9}, {3.5787584048384237`*^9, 
   3.5787584569474235`*^9}, {3.578758515327423*^9, 3.578758526143423*^9}, {
   3.5787585591984234`*^9, 3.578758566365423*^9}, {3.5787586001094236`*^9, 
   3.5787586108434234`*^9}, {3.578758753155423*^9, 3.578758917945423*^9}, {
   3.578759011603423*^9, 3.578759027490423*^9}, 3.578762148654893*^9, {
   3.578854036109888*^9, 3.578854045517426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"velStanceFootContactPoint", " ", "=", " ", 
  RowBox[{
   RowBox[{"VelCOM", "[", "stanceContactPoint", "]"}], " ", "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"velSwingFootContactPoint", " ", "=", " ", 
    RowBox[{
     RowBox[{"VelCOM", "[", "swingContactPoint", "]"}], " ", "//", 
     "Simplify"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velStanceFootCenterOfRotation", "=", 
   RowBox[{
    RowBox[{"VelCOM", "[", "stanceFoot", "]"}], " ", "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"velSwingFootCenterOfRotation", "=", 
   RowBox[{
    RowBox[{"VelCOM", "[", "swingFoot", "]"}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.446935543679307*^9, 3.446935599122636*^9}, {
   3.446935808059744*^9, 3.446935857823979*^9}, {3.446935929982038*^9, 
   3.446935951548718*^9}, {3.4469361242103558`*^9, 3.4469361388641233`*^9}, {
   3.4471108208344097`*^9, 3.44711084481641*^9}, 3.44711090527741*^9, {
   3.482142931321968*^9, 3.482142931321968*^9}, {3.4821447524906797`*^9, 
   3.482144771528054*^9}, {3.4821452640362463`*^9, 3.482145342809517*^9}, {
   3.5787590362604237`*^9, 3.5787590724174232`*^9}, {3.5787593340984235`*^9, 
   3.5787593713944235`*^9}, {3.5787596681784234`*^9, 
   3.5787596736464233`*^9}, {3.5787597811644235`*^9, 
   3.5787598257564235`*^9}, {3.5787604267107153`*^9, 3.57876043715776*^9}, {
   3.5787607697480164`*^9, 3.578760773140355*^9}, {3.5787608203900795`*^9, 
   3.5787608208221226`*^9}, {3.57876095380542*^9, 3.5787609579818373`*^9}, {
   3.578761118884926*^9, 3.5787611199720345`*^9}, {3.5787611569027276`*^9, 
   3.5787611632543626`*^9}, {3.5787612889719334`*^9, 
   3.5787612892439604`*^9}, {3.5787613762876635`*^9, 3.5787613776307983`*^9}, 
   3.578762143840411*^9, {3.5788541174405394`*^9, 3.578854133551461*^9}, 
   3.5788544271042514`*^9}],

Cell[BoxData[
 RowBox[{"VelCOM", "[", "stanceContactPoint", "]"}]], "Output",
 CellChangeTimes->{
  3.5788572537239246`*^9, {3.5788574083187675`*^9, 3.5788574377414503`*^9}, 
   3.578857727773039*^9, 3.5788577761118035`*^9, 3.5788584536465564`*^9, 
   3.578858508907717*^9, 3.578858545057785*^9, 3.5791019208401623`*^9, 
   3.579102483477719*^9, 3.57910450341329*^9, 3.57910480686529*^9, 
   3.57920055424437*^9, {3.579200697277009*^9, 3.5792007268318725`*^9}, {
   3.579200773591896*^9, 3.5792007982102795`*^9}}]
}, Open  ]],

Cell["\<\
Note that the constraint jacobian for each foot stance phase sets the contact \
point velocity to zero (which constrains the foot to act like a sphere), and \
also constrains the y component of the rotation center of the foot to 0 \
(which then makes the foot act like a cylinder). Scratch that... at the \
moment there is already no degree of freedom laterally for a rolling foot \
center with respect to the foot contact point. I posit that we\
\[CloseCurlyQuote]ll need to add that in.\
\>", "Text",
 CellChangeTimes->{{3.5787604848545294`*^9, 3.578760579098953*^9}, {
  3.5788460412015343`*^9, 3.5788460933157454`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"allVelocityVariables", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", "1", "]"}], ",", 
      RowBox[{"u", "[", "2", "]"}], ",", 
      RowBox[{"u", "[", "3", "]"}], ",", 
      RowBox[{"u", "[", "4", "]"}], ",", 
      RowBox[{"u", "[", "5", "]"}], ",", 
      RowBox[{"u", "[", "6", "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "constraintJacobianStanceFootRolling", "=", "\[IndentingNewLine]", 
    RowBox[{"LinearTerms", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"velStanceFootContactPoint", ".", 
         RowBox[{"ground", "[", "1", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"velStanceFootContactPoint", ".", 
         RowBox[{"ground", "[", "2", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"velStanceFootContactPoint", ".", 
         RowBox[{"ground", "[", "3", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"velStanceFootCenterOfRotation", ".", 
          RowBox[{"ground", "[", "2", "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "}"}], ",", "allVelocityVariables"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constraintJacobianSwingFootRolling", "=", "\[IndentingNewLine]", 
    RowBox[{"LinearTerms", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"velSwingFootContactPoint", ".", 
         RowBox[{"ground", "[", "1", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"velSwingFootContactPoint", ".", 
         RowBox[{"ground", "[", "2", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{"velSwingFootContactPoint", ".", 
         RowBox[{"ground", "[", "3", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"velSwingFootCenterOfRotation", ".", 
          RowBox[{"ground", "[", "2", "]"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "}"}], ",", "allVelocityVariables"}], "]"}]}], 
   " ", ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"definitionsOfQDots", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "1", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "1", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "2", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "2", "]"}]}], " ", ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "3", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "3", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "4", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "4", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "5", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "5", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"q", "[", "6", "]"}], ",", " ", "t"}], "]"}], "->", " ", 
       RowBox[{"u", "[", "6", "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraintJacobianStanceFootRollingDot", " ", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"constraintJacobianStanceFootRolling", ",", " ", "t"}], "]"}], 
    " ", "//.", " ", "definitionsOfQDots"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"constraintJacobianSwingFootRollingDot", " ", "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"constraintJacobianSwingFootRolling", ",", " ", "t"}], "]"}], 
     " ", "//.", " ", "definitionsOfQDots"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"subs", " ", "=", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"legMassVerticalOffset", "\[Rule]", " ", "0.5"}], ",", " ", 
     RowBox[{"legMassForwardOffset", " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{"L", " ", "\[Rule]", " ", "1"}], ",", " ", 
     RowBox[{"splayAngle", " ", "\[Rule]", " ", "0"}], ",", " ", 
     RowBox[{"pelvisWidth", " ", "\[Rule]", " ", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"constraintJacobianStanceFootRolling", " ", "//.", " ", "subs"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"constraintJacobianStanceFootRollingDot", "//.", " ", "subs"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.4821455862195234`*^9, {3.482145719411043*^9, 3.482145755573042*^9}, {
   3.4821458888647056`*^9, 3.4821459473888593`*^9}, {3.482161086324837*^9, 
   3.482161142920496*^9}, {3.4821612055157547`*^9, 3.4821612758987923`*^9}, {
   3.482161652163415*^9, 3.4821617304162397`*^9}, {3.4821617828594837`*^9, 
   3.4821618063318305`*^9}, {3.4821618420544024`*^9, 3.482161891105307*^9}, {
   3.4821619519083867`*^9, 3.4821619549086866`*^9}, 3.482171517143815*^9, 
   3.482171932650361*^9, {3.4821725598870783`*^9, 3.482172741159204*^9}, {
   3.4821727916602535`*^9, 3.4821728405131383`*^9}, {3.482172879824069*^9, 
   3.482172996406299*^9}, {3.482180713891204*^9, 3.4821808596922045`*^9}, {
   3.483215716959081*^9, 3.4832158521220884`*^9}, {3.483220165686442*^9, 
   3.483220211922927*^9}, {3.4913035137269616`*^9, 3.4913035152291217`*^9}, {
   3.491303699133563*^9, 3.4913037035198703`*^9}, {3.4913042078750973`*^9, 
   3.491304212041088*^9}, {3.491536731001107*^9, 3.491536750278827*^9}, {
   3.4915371732970977`*^9, 3.491537193105581*^9}, {3.4915372544938526`*^9, 
   3.4915372701563745`*^9}, {3.4915373368723073`*^9, 3.491537345174245*^9}, {
   3.4915374464899297`*^9, 3.4915374611910686`*^9}, {3.491537697861384*^9, 
   3.4915377157270737`*^9}, {3.578760310236374*^9, 3.5787604220102453`*^9}, {
   3.578760461378182*^9, 3.5787604640914536`*^9}, {3.578760605459589*^9, 
   3.5787606819362354`*^9}, {3.5787609284698863`*^9, 3.578760929076947*^9}, {
   3.578762317008726*^9, 3.5787623371597414`*^9}, {3.5788461845068636`*^9, 
   3.578846191539567*^9}, {3.5788543235433283`*^9, 3.578854345287572*^9}, {
   3.578856407144503*^9, 3.578856435740139*^9}, {3.578856993450038*^9, 
   3.5788570071498213`*^9}, {3.5788572090993724`*^9, 3.578857236903963*^9}, 
   3.5788573934639177`*^9, {3.5788576998204403`*^9, 3.57885770226958*^9}, {
   3.5788584260129757`*^9, 3.5788584317733054`*^9}, {3.578858527162761*^9, 
   3.5788585288288565`*^9}, {3.578858841011712*^9, 3.5788589328889675`*^9}, {
   3.5788589731842723`*^9, 3.5788589757914214`*^9}, {3.579021039284986*^9, 
   3.579021044265484*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4915371742484655`*^9, 3.4915371938967185`*^9}, {
   3.4915372714482317`*^9, 3.4915373460955696`*^9}, 3.491537431959035*^9, 
   3.4915374621524515`*^9, 3.4915377377086816`*^9, 3.4915965677869587`*^9, 
   3.491597320278989*^9, 3.491598820986901*^9, 3.5785163251990166`*^9, 
   3.5785167192672167`*^9, 3.5787537618988485`*^9, 3.5787538643320913`*^9, 
   3.5787552398254285`*^9, 3.5787555340304284`*^9, 3.5787580311514235`*^9, 
   3.5787596716114235`*^9, 3.578759705037423*^9, 3.5787607017972217`*^9, 
   3.5787607889799385`*^9, 3.5787608541194525`*^9, 3.5787609301080503`*^9, 
   3.5787610553335714`*^9, 3.578761309785014*^9, 3.5787614673357677`*^9, 
   3.5787615211381474`*^9, 3.578761570218055*^9, 3.5787616060296354`*^9, {
   3.5787616490939417`*^9, 3.5787616778858204`*^9}, 3.5787618234233727`*^9, 
   3.5787618568117113`*^9, 3.5787619129753275`*^9, {3.5787620069457235`*^9, 
   3.5787620326312914`*^9}, 3.578762075288557*^9, 3.578762124944522*^9, 
   3.578762832508271*^9, 3.5787631819552126`*^9, 3.578763224874504*^9, 
   3.578763357520767*^9, 3.578763491378152*^9, 3.5787635768857017`*^9, 
   3.578763676870425*^9, 3.5787660488770924`*^9, 3.5787662552028937`*^9, 
   3.5787688339078712`*^9, 3.578768944063172*^9, 3.578769043459857*^9, 
   3.5787690764807453`*^9, 3.5787691525140944`*^9, 3.578769808203598*^9, 
   3.578769981736523*^9, 3.5787700292882433`*^9, 3.578770328301346*^9, 
   3.5787704436579437`*^9, 3.5787706716769857`*^9, 3.5787707327454786`*^9, 
   3.578770902485203*^9, 3.5787720844774027`*^9, 3.5787721289318476`*^9, 
   3.5787725817347713`*^9, 3.5787726117407713`*^9, 3.5787727818377714`*^9, 
   3.578772836673771*^9, 3.578772881662771*^9, 3.578773081064771*^9, 
   3.5787735148327713`*^9, 3.5787735457077713`*^9, 3.578773615320771*^9, 
   3.5787746525725236`*^9, 3.578774758909277*^9, 3.578775520792458*^9, 
   3.5787755889522734`*^9, 3.578775771962572*^9, 3.5787758063801622`*^9, 
   3.578775936801162*^9, 3.578776197909162*^9, 3.578776260040162*^9, 
   3.5787764704721622`*^9, 3.578776659394162*^9, 3.5787767208671618`*^9, 
   3.5787767800241623`*^9, 3.5787768393291616`*^9, 3.578776908511162*^9, 
   3.5787769481171618`*^9, 3.578776997200162*^9, 3.5787771213921623`*^9, 
   3.5787778096161623`*^9, {3.5788397940249367`*^9, 3.5788398165239367`*^9}, 
   3.578839879403937*^9, 3.578839916909937*^9, 3.5788462298483973`*^9, 
   3.578849226872913*^9, 3.578849309740913*^9, 3.578849416475913*^9, {
   3.578849536029913*^9, 3.578849560847913*^9}, 3.578853902483245*^9, {
   3.5788543271365337`*^9, 3.5788543411053324`*^9}, 3.578854599242097*^9, 
   3.57885464509872*^9, 3.5788564363371725`*^9, 3.5788565243952093`*^9, 
   3.5788570115170717`*^9, 3.5788572537659273`*^9, {3.5788574083397684`*^9, 
   3.578857437778452*^9}, 3.5788577278080406`*^9, 3.5788577761398053`*^9, 
   3.5788584536765585`*^9, 3.578858508946719*^9, 3.5788585450987873`*^9, {
   3.5788588506562643`*^9, 3.578858933312992*^9}, 3.57910192093621*^9, 
   3.579102483529724*^9, 3.57910450344829*^9, 3.57910480690429*^9, 
   3.579200554293404*^9, {3.579200697325023*^9, 3.579200726870884*^9}, {
   3.5792007736319084`*^9, 3.579200798251292*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.4915371742484655`*^9, 3.4915371938967185`*^9}, {
   3.4915372714482317`*^9, 3.4915373460955696`*^9}, 3.491537431959035*^9, 
   3.4915374621524515`*^9, 3.4915377377086816`*^9, 3.4915965677869587`*^9, 
   3.491597320278989*^9, 3.491598820986901*^9, 3.5785163251990166`*^9, 
   3.5785167192672167`*^9, 3.5787537618988485`*^9, 3.5787538643320913`*^9, 
   3.5787552398254285`*^9, 3.5787555340304284`*^9, 3.5787580311514235`*^9, 
   3.5787596716114235`*^9, 3.578759705037423*^9, 3.5787607017972217`*^9, 
   3.5787607889799385`*^9, 3.5787608541194525`*^9, 3.5787609301080503`*^9, 
   3.5787610553335714`*^9, 3.578761309785014*^9, 3.5787614673357677`*^9, 
   3.5787615211381474`*^9, 3.578761570218055*^9, 3.5787616060296354`*^9, {
   3.5787616490939417`*^9, 3.5787616778858204`*^9}, 3.5787618234233727`*^9, 
   3.5787618568117113`*^9, 3.5787619129753275`*^9, {3.5787620069457235`*^9, 
   3.5787620326312914`*^9}, 3.578762075288557*^9, 3.578762124944522*^9, 
   3.578762832508271*^9, 3.5787631819552126`*^9, 3.578763224874504*^9, 
   3.578763357520767*^9, 3.578763491378152*^9, 3.5787635768857017`*^9, 
   3.578763676870425*^9, 3.5787660488770924`*^9, 3.5787662552028937`*^9, 
   3.5787688339078712`*^9, 3.578768944063172*^9, 3.578769043459857*^9, 
   3.5787690764807453`*^9, 3.5787691525140944`*^9, 3.578769808203598*^9, 
   3.578769981736523*^9, 3.5787700292882433`*^9, 3.578770328301346*^9, 
   3.5787704436579437`*^9, 3.5787706716769857`*^9, 3.5787707327454786`*^9, 
   3.578770902485203*^9, 3.5787720844774027`*^9, 3.5787721289318476`*^9, 
   3.5787725817347713`*^9, 3.5787726117407713`*^9, 3.5787727818377714`*^9, 
   3.578772836673771*^9, 3.578772881662771*^9, 3.578773081064771*^9, 
   3.5787735148327713`*^9, 3.5787735457077713`*^9, 3.578773615320771*^9, 
   3.5787746525725236`*^9, 3.578774758909277*^9, 3.578775520792458*^9, 
   3.5787755889522734`*^9, 3.578775771962572*^9, 3.5787758063801622`*^9, 
   3.578775936801162*^9, 3.578776197909162*^9, 3.578776260040162*^9, 
   3.5787764704721622`*^9, 3.578776659394162*^9, 3.5787767208671618`*^9, 
   3.5787767800241623`*^9, 3.5787768393291616`*^9, 3.578776908511162*^9, 
   3.5787769481171618`*^9, 3.578776997200162*^9, 3.5787771213921623`*^9, 
   3.5787778096161623`*^9, {3.5788397940249367`*^9, 3.5788398165239367`*^9}, 
   3.578839879403937*^9, 3.578839916909937*^9, 3.5788462298483973`*^9, 
   3.578849226872913*^9, 3.578849309740913*^9, 3.578849416475913*^9, {
   3.578849536029913*^9, 3.578849560847913*^9}, 3.578853902483245*^9, {
   3.5788543271365337`*^9, 3.5788543411053324`*^9}, 3.578854599242097*^9, 
   3.57885464509872*^9, 3.5788564363371725`*^9, 3.5788565243952093`*^9, 
   3.5788570115170717`*^9, 3.5788572537659273`*^9, {3.5788574083397684`*^9, 
   3.578857437778452*^9}, 3.5788577278080406`*^9, 3.5788577761398053`*^9, 
   3.5788584536765585`*^9, 3.578858508946719*^9, 3.5788585450987873`*^9, {
   3.5788588506562643`*^9, 3.578858933312992*^9}, 3.57910192093621*^9, 
   3.579102483529724*^9, 3.57910450344829*^9, 3.57910480690429*^9, 
   3.579200554293404*^9, {3.579200697325023*^9, 3.579200726870884*^9}, {
   3.5792007736319084`*^9, 3.5792007982592945`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameterized Initial Conditions", "Section",
 CellChangeTimes->{{3.446936522284877*^9, 3.446936526233658*^9}, {
  3.482180100156204*^9, 3.4821801031942043`*^9}, {3.4912330568604145`*^9, 
  3.491233063540019*^9}}],

Cell["\<\

Find initial conditions given gravitational energy, spring energy, kinetic \
energy, com velocity elevation angle, \
\>", "Text",
 CellChangeTimes->{{3.4469366383944397`*^9, 3.446936650030229*^9}, {
  3.4821442962045727`*^9, 3.482144427222968*^9}, {3.4821444934081373`*^9, 
  3.482144572612027*^9}, {3.482144603216034*^9, 3.4821447118923025`*^9}, {
  3.4821458209270163`*^9, 3.482145874433955*^9}, {3.482180118674204*^9, 
  3.4821801373532043`*^9}, {3.4912330719821587`*^9, 3.49123310658191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialConditionConstraints", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"kineticEnergy", " ", "-", " ", "KE"}], ",", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"0.5", " ", "*", " ", "totalMass", " ", "*", " ", 
          RowBox[{"comVelocity", ".", "comVelocity"}]}], " ", ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"gravityPotentialEnergy", "-", " ", "PEGravity"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"springPotentialEnergy", " ", "-", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "KFoot", " ", 
           RowBox[{"q", "[", "3", "]"}], 
           RowBox[{"q", "[", "3", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], "KFoot", " ", 
           RowBox[{"q", "[", "4", "]"}], 
           RowBox[{"q", "[", "4", "]"}]}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "gravityPotentialEnergy", "-", " ", "PEGravity", " ", "+", " ", 
          "springPotentialEnergy", " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "KFoot", " ", 
             RowBox[{"q", "[", "3", "]"}], 
             RowBox[{"q", "[", "3", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], "KFoot", " ", 
             RowBox[{"q", "[", "4", "]"}], 
             RowBox[{"q", "[", "4", "]"}]}]}], ")"}]}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"comVelocityAngleAboveHorizontal", " ", "-", " ", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"comVelocity", ".", 
           RowBox[{"ground", "[", "1", "]"}]}], ",", " ", 
          RowBox[{"comVelocity", ".", 
           RowBox[{"ground", "[", "2", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kineticEnergySwingLeg", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Mass", "[", "swi", "]"}], "*", 
             RowBox[{
              RowBox[{"VelCOM", "[", "swi", "]"}], ".", 
              RowBox[{"VelCOM", "[", "swi", "]"}]}]}], " ", "+", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Mass", "[", "swingShank", "]"}], "*", 
             RowBox[{
              RowBox[{"VelCOM", "[", "swingShank", "]"}], ".", 
              RowBox[{"VelCOM", "[", "swingShank", "]"}]}]}], " ", "+", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Mass", "[", "swingFoot", "]"}], "*", 
             RowBox[{
              RowBox[{"VelCOM", "[", "swingFoot", "]"}], ".", 
              RowBox[{"VelCOM", "[", "swingFoot", "]"}]}]}], " ", "+", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inertia", "[", "swi", "]"}], ".", 
             RowBox[{"AngVel", "[", "swi", "]"}], ".", 
             RowBox[{"AngVel", "[", "swi", "]"}]}], " ", "+", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inertia", "[", "swingShank", "]"}], ".", 
             RowBox[{"AngVel", "[", "swingShank", "]"}], ".", 
             RowBox[{"AngVel", "[", "swingShank", "]"}]}], " ", "+", " ", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inertia", "[", "swingFoot", "]"}], ".", 
             RowBox[{"AngVel", "[", "swingFoot", "]"}], ".", 
             RowBox[{"AngVel", "[", "swingFoot", "]"}]}]}], ")"}]}]}], " ", "//",
         " ", "Simplify"}], ",", "\[IndentingNewLine]", 
       RowBox[{"stanceFootY", " ", "-", " ", "R"}], " ", ",", 
       "\[IndentingNewLine]", "stanceFootX", ",", "\[IndentingNewLine]", 
       RowBox[{"swingFootY", " ", "-", " ", "R"}], " ", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "[", "4", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"u", "[", "4", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], " ", "-", " ", 
        RowBox[{"q", "[", "7", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "[", "2", "]"}], " ", "-", " ", 
        RowBox[{"q", "[", "8", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rollingConstraintOnLockedLegStance", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ".", 
        RowBox[{"ground", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rollingConstraintOnLockedLegStance", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ".", 
        RowBox[{"ground", "[", "2", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"rollingConstraintOnLockedLegSwing", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", 
          RowBox[{"ground", "[", "1", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rollingConstraintOnLockedLegSwing", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ".", 
          RowBox[{"ground", "[", "2", "]"}]}], ","}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"stanceLegLockedConstraint", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"swingLegLockedConstraint", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"0.5", " ", "*", " ", "totalMass", " ", "*", " ", 
     RowBox[{"comVelocity", ".", "comVelocity"}], " ", 
     RowBox[{"(*", 
      RowBox[{"//", "Simplify"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"0.5", " ", "*", " ", "totalMass", " ", "*", " ", 
       RowBox[{"comVelocity", ".", "comVelocity"}]}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"0.5", " ", "*", " ", "totalMass", " ", "*", " ", 
       RowBox[{"comVelocity", ".", "comVelocity"}]}], ",", 
      RowBox[{"Element", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"q", "[", "1", "]"}], ",", " ", 
          RowBox[{"q", "[", "2", "]"}]}], "}"}], ",", "Reals"}], "]"}]}], 
     "]"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Solve", "[", 
     RowBox[{"initialConditionConstraints", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"q", "[", "1", "]"}], ",", " ", 
        RowBox[{"q", "[", "2", "]"}], ",", " ", 
        RowBox[{"q", "[", "3", "]"}], ",", " ", 
        RowBox[{"q", "[", "4", "]"}], ",", " ", 
        RowBox[{"q", "[", "5", "]"}], ",", " ", 
        RowBox[{"q", "[", "6", "]"}], ",", " ", 
        RowBox[{"q", "[", "7", "]"}], ",", " ", 
        RowBox[{"q", "[", "8", "]"}], ",", 
        RowBox[{"u", "[", "1", "]"}], ",", " ", 
        RowBox[{"u", "[", "2", "]"}], ",", " ", 
        RowBox[{"u", "[", "3", "]"}], ",", " ", 
        RowBox[{"u", "[", "4", "]"}], ",", " ", 
        RowBox[{"u", "[", "5", "]"}], ",", " ", 
        RowBox[{"u", "[", "6", "]"}], ",", 
        RowBox[{"u", "[", "7", "]"}], ",", " ", 
        RowBox[{"u", "[", "8", "]"}]}], "}"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.446935543679307*^9, 3.446935599122636*^9}, {
   3.446935808059744*^9, 3.446935857823979*^9}, {3.446935929982038*^9, 
   3.446935951548718*^9}, {3.4469361242103558`*^9, 3.4469361388641233`*^9}, {
   3.4471108208344097`*^9, 3.44711084481641*^9}, 3.44711090527741*^9, {
   3.482142931321968*^9, 3.482142931321968*^9}, {3.4821447524906797`*^9, 
   3.482144771528054*^9}, {3.4821452640362463`*^9, 3.482145342809517*^9}, {
   3.482180166634204*^9, 3.482180241325204*^9}, {3.4821804823242044`*^9, 
   3.482180522189204*^9}, {3.4821805535632043`*^9, 3.482180669773204*^9}, {
   3.482181021981204*^9, 3.482181089575204*^9}, {3.4821812127322044`*^9, 
   3.482181225667204*^9}, {3.482181265289204*^9, 3.482181369539204*^9}, {
   3.4821818544702044`*^9, 3.482181870433204*^9}, {3.4821819669452043`*^9, 
   3.482182080349204*^9}, {3.4821821181352043`*^9, 3.4821821955762043`*^9}, {
   3.482182236735204*^9, 3.482182308554204*^9}, {3.4821837717652044`*^9, 
   3.482183804309204*^9}, {3.4821838841922045`*^9, 3.4821838896952043`*^9}, {
   3.482183955052204*^9, 3.482184017236204*^9}, {3.4821840489872046`*^9, 
   3.4821840714092045`*^9}, {3.4821846973782043`*^9, 
   3.4821846977912045`*^9}, {3.482187446781204*^9, 3.482187462605204*^9}, {
   3.482187504132204*^9, 3.4821875923782043`*^9}, {3.4821880850812044`*^9, 
   3.482188166834204*^9}, {3.4821882190412045`*^9, 3.4821882199492044`*^9}, 
   3.4821882775602045`*^9, {3.4821884972062044`*^9, 3.482188514183204*^9}, {
   3.4821905998062043`*^9, 3.482190617679204*^9}, {3.482190789973204*^9, 
   3.4821908211612043`*^9}, {3.4823344128998117`*^9, 
   3.4823344531318116`*^9}, {3.4824328743230295`*^9, 3.482432879268029*^9}, {
   3.482443227091878*^9, 3.482443230695238*^9}, {3.4832152405788307`*^9, 
   3.4832152450552225`*^9}, {3.4912330432608595`*^9, 
   3.4912330532552304`*^9}, {3.4913035058556433`*^9, 
   3.4913035064364786`*^9}, {3.491303538752947*^9, 3.4913035560878735`*^9}, {
   3.4913035864515343`*^9, 3.491303602785021*^9}, {3.4913037157073956`*^9, 
   3.491303723308325*^9}, 3.491303766570533*^9, 3.4913038375526*^9, {
   3.4913039074330835`*^9, 3.491304005093512*^9}, {3.4913041373837357`*^9, 
   3.4913041827589827`*^9}, {3.491304224078397*^9, 3.4913042243888435`*^9}, {
   3.491304298385245*^9, 3.4913044371647997`*^9}, {3.491304510640453*^9, 
   3.4913046524744*^9}, {3.4913047666786175`*^9, 3.491304835036912*^9}, {
   3.491304877668213*^9, 3.4913049124382095`*^9}, {3.491305215503997*^9, 
   3.491305226880355*^9}, {3.4913053988876896`*^9, 3.491305411165344*^9}, {
   3.4913055428446894`*^9, 3.4913055996864243`*^9}, {3.4913056606841345`*^9, 
   3.491305678319493*^9}, {3.491305936620912*^9, 3.4913059381531153`*^9}, {
   3.4913061505885825`*^9, 3.491306154053565*^9}, {3.491306274136235*^9, 
   3.4913062770303965`*^9}, {3.491315502333763*^9, 3.4913156079356112`*^9}, {
   3.491315941735592*^9, 3.4913159647186403`*^9}, {3.491316116416771*^9, 
   3.4913161166270733`*^9}, {3.4913161761827106`*^9, 3.491316176372984*^9}, {
   3.491355550404973*^9, 3.491355587708613*^9}, {3.4913559405559826`*^9, 
   3.491355946704824*^9}, {3.491357275064912*^9, 3.4913572775584974`*^9}, {
   3.4913582369580464`*^9, 3.491358241574685*^9}, {3.4913587643163505`*^9, 
   3.4913587758128815`*^9}, {3.4913931696648417`*^9, 
   3.4913931918667665`*^9}, {3.4914270812623568`*^9, 
   3.4914270962238703`*^9}, {3.4914275026082225`*^9, 
   3.4914275237986927`*^9}, {3.491427980555477*^9, 3.491427983830186*^9}, {
   3.4914281236011667`*^9, 3.491428126665573*^9}, {3.4915678849382687`*^9, 
   3.491567887401811*^9}, {3.4915965430513906`*^9, 3.4915965481787634`*^9}, {
   3.4915972775675726`*^9, 3.491597279129819*^9}, {3.491597621211709*^9, 
   3.491597628221789*^9}, {3.491597677422536*^9, 3.491597746441781*^9}, {
   3.578762191600187*^9, 3.578762198843911*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Export expressions in Matlab format", "Section",
 CellChangeTimes->{{3.446937222052465*^9, 3.4469372272078342`*^9}, {
  3.4479795986645265`*^9, 3.4479796140455265`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"inGroundFrame", "[", "v_", "]"}], " ", ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "1", "]"}]}], ",", " ", 
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "2", "]"}]}], ",", " ", 
       RowBox[{"v", ".", 
        RowBox[{"ground", "[", "3", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"expressionsToExport", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianSwingFootRolling", ",", 
         "\"\<constraintJacobianSwingFootRolling\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianSwingFootRollingDot", ",", 
         "\"\<constraintJacobianSwingFootRollingDot\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianStanceFootRolling", ",", 
         "\"\<constraintJacobianStanceFootRolling\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "constraintJacobianStanceFootRollingDot", ",", 
         "\"\<constraintJacobianStanceFootRollingDot\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"PE", ",", " ", "\"\<PE\>\""}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"PEGravity", ",", " ", "\"\<PEGravity\>\""}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"PESpring", ",", " ", "\"\<PESpring\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"KE", ",", " ", "\"\<KE\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "pelvisPosition", "]"}], ",", 
         "\"\<points.pelvis.position\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pelvisR", ",", "\"\<points.pelvis.R\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "stanceLegPosition", "]"}], ",", 
         "\"\<points.stanceLeg.position\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"stanceLegR", ",", "\"\<points.stanceLeg.R\>\""}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "swingLegPosition", "]"}], ",", 
         "\"\<points.swingLeg.position\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"swingLegR", ",", "\"\<points.swingLeg.R\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "stanceFootCenter", "]"}], ",", 
         "\"\<points.stanceFootCenter\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "swingFootCenter", "]"}], ",", 
         "\"\<points.swingFootCenter\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "stanceFootContactPoint", "]"}], ",", 
         "\"\<points.stanceFootContactPoint\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "swingFootContactPoint", "]"}], ",", 
         "\"\<points.swingFootContactPoint\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "stanceHipPoint", "]"}], ",", 
         "\"\<points.stanceHipPoint\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "swingHipPoint", "]"}], ",", 
         "\"\<points.swingHipPoint\>\""}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "comVelocity", "]"}], ",", " ", 
         "\"\<points.comVelocity\>\""}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "centerOfMassPosition", "]"}], ",", 
         " ", "\"\<points.centerOfMassPosition\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "totalForceOnCOM", "]"}], ",", " ", 
         "\"\<points.totalForceOnCOM\>\""}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "totalTorqueAroundCOM", "]"}], ",", 
         " ", "\"\<points.totalTorqueAroundCOM\>\""}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"inGroundFrame", "[", "velStanceFootContactPoint", "]"}], 
         ",", " ", "\"\<points.velStanceFootContactPoint\>\""}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.482161321647367*^9, 3.482161356313833*^9}, {
   3.482161933457542*^9, 3.4821619485240483`*^9}, {3.4821716004951487`*^9, 
   3.482171738958994*^9}, {3.482171816804778*^9, 3.4821718333504324`*^9}, {
   3.482171872483345*^9, 3.4821719113702335`*^9}, {3.482172142339328*^9, 
   3.4821721464427385`*^9}, {3.4821734981882854`*^9, 
   3.4821734986218514`*^9}, {3.482181382900204*^9, 3.4821813951072044`*^9}, {
   3.482181602363204*^9, 3.482181604707204*^9}, {3.482181648657204*^9, 
   3.4821816517772045`*^9}, {3.482181880507204*^9, 3.482181912019204*^9}, {
   3.482182418028204*^9, 3.4821824209372044`*^9}, {3.4821850598172045`*^9, 
   3.482185088046204*^9}, {3.4821877332722044`*^9, 3.4821877377212043`*^9}, {
   3.482187988526204*^9, 3.4821879892742043`*^9}, {3.4832194606125956`*^9, 
   3.483219538704887*^9}, {3.4832198142010307`*^9, 3.48321981863741*^9}, {
   3.483298486402483*^9, 3.483298492461195*^9}, {3.490230651193972*^9, 
   3.490230680516904*^9}, {3.490291405300268*^9, 3.4902914138815565`*^9}, {
   3.490291726710726*^9, 3.490291738343052*^9}, {3.4902918081690145`*^9, 
   3.4902918110245857`*^9}, {3.4902962380450835`*^9, 
   3.4902962742567043`*^9}, {3.490300279283167*^9, 3.490300312386477*^9}, {
   3.4913052765617933`*^9, 3.4913052770424848`*^9}, {3.4913161334512653`*^9, 
   3.4913161961113663`*^9}, {3.491316239493747*^9, 3.4913162630976877`*^9}, {
   3.491317267371763*^9, 3.4913173241834545`*^9}, {3.491317748814043*^9, 
   3.491317753170307*^9}, {3.578762227373764*^9, 3.5787622332113476`*^9}, {
   3.5787622912061462`*^9, 3.578762306510677*^9}, {3.578762349940019*^9, 
   3.578762426615686*^9}, {3.578762458950919*^9, 3.578762659546977*^9}, {
   3.5787627506420856`*^9, 3.5787628165306735`*^9}, {3.578762848244845*^9, 
   3.578762854070427*^9}, {3.578763094001418*^9, 3.578763164821499*^9}, {
   3.5787632736103773`*^9, 3.578763291900206*^9}, {3.5787633410511203`*^9, 
   3.578763369402955*^9}, {3.57876347226024*^9, 3.5787635048655005`*^9}, {
   3.578763561589172*^9, 3.5787635634463577`*^9}, {3.578765984405405*^9, 
   3.578765988275626*^9}, {3.578766018876377*^9, 3.5787660271248484`*^9}, {
   3.57877030844621*^9, 3.578770309599276*^9}, {3.578770700749648*^9, 
   3.5787707126013265`*^9}, {3.578772543460771*^9, 3.578772559927771*^9}, 
   3.578772593390771*^9, {3.578772753504771*^9, 3.5787728165287714`*^9}, {
   3.578772849769771*^9, 3.578772858386771*^9}, {3.5787730255927715`*^9, 
   3.5787730333167715`*^9}, {3.5787734959317713`*^9, 3.578773522202771*^9}, {
   3.5787735973447714`*^9, 3.5787735980617714`*^9}, {3.5787746301550407`*^9, 
   3.578774631293268*^9}, {3.5787747382566566`*^9, 3.5787747393938847`*^9}, {
   3.578775500850464*^9, 3.5787755034077196`*^9}, {3.578775544172796*^9, 
   3.5787755689472733`*^9}, 3.5787756794223194`*^9, {3.578775786509162*^9, 
   3.5787757865901623`*^9}, {3.5787758713811617`*^9, 3.578775917345162*^9}, {
   3.578776171799162*^9, 3.5787761770581617`*^9}, 3.578777791535162*^9, {
   3.578839850768937*^9, 3.5788398612629366`*^9}, {3.578839898779937*^9, 
   3.578839901883937*^9}, {3.5788560078346643`*^9, 3.578856009913783*^9}, {
   3.578856500202826*^9, 3.578856510491414*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExportCode", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
    RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
    
    RowBox[{
    "OutputFile", "->", 
     "\"\<C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\\
Branches\\\\jrebula\\\\ThreeDWalker\\\\mathematicaOutput.m\>\""}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ExportCode", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
     RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
     RowBox[{
     "OutputFile", "->", 
      "\"\<C:\\\\Users\\\\hbclStudent\\\\Documents\\\\mathematicaOutput.m\>\"\
"}]}], "]"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"ExportCode", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"MM", ",", "rhs"}], "}"}], ",", " ", 
     RowBox[{"Expressions", "\[Rule]", " ", "expressionsToExport"}], ",", " ", 
     RowBox[{
     "OutputFile", "->", 
      "\"\<D:\\\\myProjects\\\\SpringyWalking\\\\mathematica models from \
kishore\\\\springyWalkerWithKnees\\\\mathemticaOutput.m\>\""}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.447585536668432*^9, 3.447585549638657*^9}, {
   3.44759301796579*^9, 3.447593018875005*^9}, {3.482171540061106*^9, 
   3.4821715907761774`*^9}, {3.483289839649062*^9, 3.4832898504245567`*^9}, {
   3.483289935587014*^9, 3.4832899395427027`*^9}, {3.4844722124239798`*^9, 
   3.484472215151136*^9}, {3.491316324455917*^9, 3.4913163383959618`*^9}, {
   3.5787608391449547`*^9, 3.5787608420552464`*^9}, {3.5787622379098177`*^9, 
   3.5787622408041067`*^9}, {3.5787622717562017`*^9, 3.578762273159342*^9}, {
   3.578769783680195*^9, 3.578769789036502*^9}, {3.5787700002545824`*^9, 
   3.578770003491768*^9}, {3.578770609360421*^9, 3.5787706383740807`*^9}, {
   3.5787708776798983`*^9, 3.578770878098274*^9}, {3.5787721037493296`*^9, 
   3.5787721057515297`*^9}, 3.578772745741771*^9, {3.578777775412162*^9, 
   3.578777782107162*^9}, 3.5788395181229367`*^9, {3.5788583953302207`*^9, 
   3.5788583964652863`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Opening file \\\"\"\>", 
   "\[InvisibleSpace]", \
"\<\"C:\\\\Users\\\\hbclStudent\\\\workspace\\\\dynamicWalking\\\\Branches\\\\\
jrebula\\\\ThreeDWalker\\\\mathematicaOutput.m\"\>", 
   "\[InvisibleSpace]", "\<\"\\\"\"\>"}],
  SequenceForm[
  "Opening file \"", 
   "C:\\Users\\hbclStudent\\workspace\\dynamicWalking\\Branches\\jrebula\\\
ThreeDWalker\\mathematicaOutput.m", "\""],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5787704446169987`*^9, 3.5787706733030787`*^9, 3.5787707329694915`*^9, 
   3.5787709029476185`*^9, 3.5787720847294283`*^9, 3.578772129185873*^9, 
   3.578772581841771*^9, 3.5787726118637714`*^9, 3.578772781946771*^9, 
   3.5787728367577715`*^9, 3.578772881762771*^9, 3.5787730811987715`*^9, 
   3.578773515317771*^9, 3.578773545795771*^9, 3.578773615402771*^9, 
   3.57877465300461*^9, 3.5787747590462914`*^9, 3.578775520942473*^9, 
   3.578775589068285*^9, 3.578775772098586*^9, 3.578775806520162*^9, 
   3.5787759370641623`*^9, 3.5787761980641623`*^9, 3.578776260203162*^9, 
   3.578776470593162*^9, 3.5787766595311623`*^9, 3.578776721111162*^9, 
   3.578776780154162*^9, 3.578776839467162*^9, 3.578776908712162*^9, 
   3.578776948372162*^9, 3.5787769974391623`*^9, 3.5787771216091623`*^9, 
   3.578777809773162*^9, {3.5788397941969366`*^9, 3.5788398165979366`*^9}, 
   3.578839879489937*^9, 3.5788399170439367`*^9, 3.5788462299584084`*^9, 
   3.578849226964913*^9, 3.5788493098089128`*^9, 3.578849416569913*^9, {
   3.5788495361609125`*^9, 3.578849560945913*^9}, 3.578853902562249*^9, 
   3.578854599384105*^9, 3.5788546451917253`*^9, 3.5788565245262175`*^9, 
   3.578857253882934*^9, {3.5788574084187727`*^9, 3.5788574379034595`*^9}, 
   3.57885772797205*^9, 3.5788577762418113`*^9, 3.5788584537755637`*^9, 
   3.578858509064726*^9, 3.578858545244796*^9, 3.5791019211213026`*^9, 
   3.579102483659737*^9, 3.5791045035342903`*^9, 3.5791048069872904`*^9, 
   3.5792005544345026`*^9, {3.5792006973910427`*^9, 3.5792007270189285`*^9}, {
   3.579200773694927*^9, 3.5792007983203125`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Current directory: \"\>", 
   "\[InvisibleSpace]", "\<\"C:\\\\Users\\\\hbclStudent\\\\Documents\"\>"}],
  SequenceForm["Current directory: ", "C:\\Users\\hbclStudent\\Documents"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.5787704446169987`*^9, 3.5787706733030787`*^9, 3.5787707329694915`*^9, 
   3.5787709029476185`*^9, 3.5787720847294283`*^9, 3.578772129185873*^9, 
   3.578772581841771*^9, 3.5787726118637714`*^9, 3.578772781946771*^9, 
   3.5787728367577715`*^9, 3.578772881762771*^9, 3.5787730811987715`*^9, 
   3.578773515317771*^9, 3.578773545795771*^9, 3.578773615402771*^9, 
   3.57877465300461*^9, 3.5787747590462914`*^9, 3.578775520942473*^9, 
   3.578775589068285*^9, 3.578775772098586*^9, 3.578775806520162*^9, 
   3.5787759370641623`*^9, 3.5787761980641623`*^9, 3.578776260203162*^9, 
   3.578776470593162*^9, 3.5787766595311623`*^9, 3.578776721111162*^9, 
   3.578776780154162*^9, 3.578776839467162*^9, 3.578776908712162*^9, 
   3.578776948372162*^9, 3.5787769974391623`*^9, 3.5787771216091623`*^9, 
   3.578777809773162*^9, {3.5788397941969366`*^9, 3.5788398165979366`*^9}, 
   3.578839879489937*^9, 3.5788399170439367`*^9, 3.5788462299584084`*^9, 
   3.578849226964913*^9, 3.5788493098089128`*^9, 3.578849416569913*^9, {
   3.5788495361609125`*^9, 3.578849560945913*^9}, 3.578853902562249*^9, 
   3.578854599384105*^9, 3.5788546451917253`*^9, 3.5788565245262175`*^9, 
   3.578857253882934*^9, {3.5788574084187727`*^9, 3.5788574379034595`*^9}, 
   3.57885772797205*^9, 3.5788577762418113`*^9, 3.5788584537755637`*^9, 
   3.578858509064726*^9, 3.578858545244796*^9, 3.5791019211213026`*^9, 
   3.579102483659737*^9, 3.5791045035342903`*^9, 3.5791048069872904`*^9, 
   3.5792005544345026`*^9, {3.5792006973910427`*^9, 3.5792007270189285`*^9}, {
   3.579200773694927*^9, 3.579200798325314*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Last", "::", "nolast"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({}\\)\[NoBreak] has a length of zero and \
no last element. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Last/nolast\
\\\", ButtonNote -> \\\"Last::nolast\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006974660654`*^9, 3.5792007271019535`*^9}, {
  3.5792007737629476`*^9, 3.57920079841234*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Last", "::", "nolast"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({}\\)\[NoBreak] has a length of zero and \
no last element. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Last/nolast\
\\\", ButtonNote -> \\\"Last::nolast\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006974660654`*^9, 3.5792007271019535`*^9}, {
  3.5792007737629476`*^9, 3.579200798456353*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Last", "::", "nolast"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({}\\)\[NoBreak] has a length of zero and \
no last element. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Last/nolast\
\\\", ButtonNote -> \\\"Last::nolast\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006974660654`*^9, 3.5792007271019535`*^9}, {
  3.5792007737629476`*^9, 3.5792007985013666`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Last :: \
nolast\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.5792006974660654`*^9, 3.5792007271019535`*^9}, {
  3.5792007737629476`*^9, 3.57920079854538*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1584, 765},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 242, 3, 90, "Title"],
Cell[812, 27, 269, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1106, 36, 103, 1, 79, "Section"],
Cell[1212, 39, 653, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[1890, 53, 265, 5, 34, "Subsubsection"],
Cell[2158, 60, 2262, 45, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4457, 110, 322, 5, 34, "Subsubsection"],
Cell[4782, 117, 689, 10, 49, "Text"],
Cell[5474, 129, 8970, 193, 452, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14481, 327, 228, 3, 34, "Subsubsection"],
Cell[CellGroupData[{
Cell[14734, 334, 10119, 185, 472, "Input"],
Cell[24856, 521, 580, 11, 21, "Message"],
Cell[25439, 534, 579, 11, 21, "Message"],
Cell[26021, 547, 380, 9, 31, "Output"],
Cell[26404, 558, 581, 11, 21, "Message"],
Cell[26988, 571, 580, 11, 21, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27617, 588, 366, 6, 34, "Subsubsection"],
Cell[CellGroupData[{
Cell[28008, 598, 10739, 258, 1112, "Input"],
Cell[38750, 858, 881, 23, 101, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[39692, 888, 152, 2, 79, "Section"],
Cell[39847, 892, 422, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[40294, 901, 8439, 206, 572, "Input"],
Cell[48736, 1109, 631, 12, 70, "Message"],
Cell[49370, 1123, 631, 12, 70, "Message"],
Cell[50004, 1137, 658, 13, 70, "Message"],
Cell[50665, 1152, 606, 12, 70, "Message"],
Cell[51274, 1166, 630, 12, 70, "Message"],
Cell[51907, 1180, 630, 12, 70, "Message"],
Cell[52540, 1194, 657, 13, 70, "Message"],
Cell[53200, 1209, 607, 12, 70, "Message"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[53856, 1227, 105, 1, 49, "Section"],
Cell[53964, 1230, 1941, 34, 182, "Text"],
Cell[CellGroupData[{
Cell[55930, 1268, 1929, 37, 112, "Input"],
Cell[57862, 1307, 513, 8, 70, "Output"]
}, Open  ]],
Cell[58390, 1318, 633, 10, 49, "Text"],
Cell[CellGroupData[{
Cell[59048, 1332, 6897, 147, 572, "Input"],
Cell[65948, 1481, 3810, 61, 70, "Output"],
Cell[69761, 1544, 3812, 61, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[73622, 1611, 219, 3, 49, "Section"],
Cell[73844, 1616, 507, 9, 68, "Text"],
Cell[74354, 1627, 11492, 228, 852, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[85883, 1860, 175, 2, 49, "Section"],
Cell[86061, 1864, 8116, 165, 492, "Input"],
Cell[CellGroupData[{
Cell[94202, 2033, 2245, 47, 132, "Input"],
Cell[CellGroupData[{
Cell[96472, 2084, 2073, 34, 23, "Print"],
Cell[98548, 2120, 1867, 28, 23, "Print"]
}, Open  ]],
Cell[100430, 2151, 528, 10, 21, "Message"],
Cell[100961, 2163, 529, 10, 21, "Message"],
Cell[101493, 2175, 531, 10, 21, "Message"],
Cell[102027, 2187, 607, 12, 21, "Message"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
